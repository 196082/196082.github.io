<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="196082">
    
    <title>
        
            syzkalleråŸºæœ¬ä½¿ç”¨ |
        
        196082&#39;s blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    
        <link rel="shortcut icon" href="/images/ufo.ico">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.2/font/css/fontawesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.2/font/css/regular.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.2/font/css/solid.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.2/font/css/brands.min.css">
    
    <script class="keep-theme-configurations">
    const KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"196082.github.io","root":"/","language":"zh-CN","path":"search.json"}
    KEEP.theme_config = {"base_info":{"primary_color":"#0066cc","title":"196082's blog","author":196082,"avatar":"/images/ling.jpg","logo":"/images/ling.jpg","favicon":"/images/ufo.ico"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-folder","tags":"/tags || fa-solid fa-tags"},"first_screen":{"enable":false,"background_img":"/images/bg.svg","background_img_dark":"/images/bg.svg","description":"Keep writing and Keep loving.","hitokoto":false},"social_contact":{"enable":false,"links":{"github":null,"weixin":null,"qq":null,"weibo":null,"zhihu":null,"twitter":null,"x":null,"facebook":null,"email":null}},"scroll":{"progress_bar":false,"percent":false,"hide_header":true},"home":{"announcement":"è¯„è®ºé‚®ä»¶é€šçŸ¥çš„åŠŸèƒ½å·²å¼€å¯ï¼Œæ¬¢è¿å¤§å®¶ç•™è¨€è¯„è®ºï¼Œæœ‰é—®é¢˜æˆ‘ä¼šåŠæ—¶å›å¤çš„å“¦ï½","category":true,"tag":true,"post_datetime":"updated"},"post":{"author_badge":{"enable":true,"level_badge":false,"custom_badge":"æ…¢æ…¢å¥½èµ·æ¥"},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":false,"share":false},"code_block":{"tools":{"enable":true,"style":"default"},"highlight_theme":"default"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":true},"comment":{"enable":true,"use":"valine","valine":{"appid":"OcvtJuJHDrSFIyDGdp3rLMtA-gzGzoHsz","appkey":"C672AAYGXMkHxztf8ntdLShs","server_urls":null,"placeholder":"ğŸ˜œè‹¥æœ‰é—®é¢˜è¯·å„ä½å¤§å¸ˆå‚…ç•™è¨€è¯„è®ºï¼ˆç•™ä¸‹é‚®ç®±æœ‰é€šçŸ¥å“¦ï½ï¼‰"},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.36"},"waline":{"server_url":null,"reaction":false,"version":"3.2.1"},"giscus":{"repo":null,"repo_id":null,"category":"Announcements","category_id":null,"reactions_enabled":false},"artalk":{"server":null},"disqus":{"shortname":null}},"rss":{"enable":true},"lazyload":{"enable":true},"cdn":{"enable":true,"provider":"cdnjs"},"pjax":{"enable":false},"footer":{"since":2020,"word_count":true,"site_deploy":{"enable":true,"provider":"github","url":null},"record":{"enable":false,"list":[{"code":null,"link":null}]}},"inject":{"enable":false,"css":[null],"js":[null]},"root":"","source_data":{},"version":"4.2.2"}
    KEEP.language_ago = {"second":"%s ç§’å‰","minute":"%s åˆ†é’Ÿå‰","hour":"%s å°æ—¶å‰","day":"%s å¤©å‰","week":"%s å‘¨å‰","month":"%s ä¸ªæœˆå‰","year":"%s å¹´å‰"}
    KEEP.language_code_block = {"copy":"å¤åˆ¶ä»£ç ","copied":"å·²å¤åˆ¶","fold":"æŠ˜å ä»£ç å—","folded":"å·²æŠ˜å "}
    KEEP.language_copy_copyright = {"copy":"å¤åˆ¶ç‰ˆæƒä¿¡æ¯","copied":"å·²å¤åˆ¶","title":"åŸæ–‡æ ‡é¢˜","author":"åŸæ–‡ä½œè€…","link":"åŸæ–‡é“¾æ¥"}
  </script>
<meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="196082's blog" type="application/atom+xml">
</head>


<body>
<div class="progress-bar-container">
    

    
</div>



<main class="page-container border-box">
    <!-- home first screen  -->
    

    <!-- page content -->
    <div class="page-main-content border-box">
        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="border-box header-content">
        <div class="left flex-start border-box">
            
                <a class="logo-image border-box" href="/">
                    <img src="/images/ling.jpg">
                </a>
            
            <a class="site-name border-box" href="/">
               196082&#39;s blog
            </a>
        </div>

        <div class="right border-box">
            <div class="pc border-box">
                <ul class="menu-list border-box">
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-home"></i>
                                
                                é¦–é¡µ
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/archives">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-box-archive"></i>
                                
                                å½’æ¡£
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/categories">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-folder"></i>
                                
                                åˆ†ç±»
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/tags">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-tags"></i>
                                
                                æ ‡ç­¾
                                
                            </a>
                            
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="menu-text-color fas search fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile border-box flex-start">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list border-box">
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-home"></i>
                                </span>
                            
                            é¦–é¡µ
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/archives">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-box-archive"></i>
                                </span>
                            
                            å½’æ¡£
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/categories">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-folder"></i>
                                </span>
                            
                            åˆ†ç±»
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/tags">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-tags"></i>
                                </span>
                            
                            æ ‡ç­¾
                        </a>
                        
                    </label>
                    
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle border-box">

            <div class="main-content border-box">
                

                    
<div class="fade-in-down-animation">
    <div class="post-page-container border-box">
        <div class="post-content-container border-box">
            

            <div class="post-content-bottom border-box">
                
                    <div class="post-title">
                        syzkalleråŸºæœ¬ä½¿ç”¨
                    </div>
                

                
                    <div class="post-header border-box">
                        
                            <div class="avatar-box border-box">
                                <img src="/images/ling.jpg">
                            </div>
                        
                        <div class="info-box">
                            <div class="author border-box">
                                <span class="name">196082</span>
                                
                                    <span class="author-badge">æ…¢æ…¢å¥½èµ·æ¥</span>
                                
                            </div>
                            <div class="meta-info border-box">
                                

<div class="post-meta-info-container border-box post">
    <div class="post-meta-info border-box">
        

        
            <span class="meta-info-item post-create-date">
                <i class="icon fa-solid fa-calendar-plus"></i>&nbsp;
                <span class="datetime">2023-11-10 17:04:05</span>
            </span>

            <span class="meta-info-item post-update-date">
                <i class="icon fa-solid fa-file-pen"></i>&nbsp;
                <span class="datetime" data-updated="Wed Jun 12 2024 20:51:43 GMT+0800">2024-06-12 20:51:43</span>
            </span>
        

        
            <span class="meta-info-item post-category border-box"><i class="icon fas fa-folder"></i>&nbsp;
                <ul class="post-category-ul">
                    
                            <li class="category-item"><a href="/categories/fuzzing/">fuzzing</a></li>
                        
                    
                </ul>
            </span>
        

        
            <span class="post-tag meta-info-item border-box">
                <ul class="post-tag-ul">
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/fuzzing/">fuzzing</a></li>
                        
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/LKM/">LKM</a></li>
                        
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/syzkaller/">syzkaller</a></li>
                        
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/syzlang/">syzlang</a></li>
                        
                    
                </ul>
            </span>
        

        
        
            <span class="meta-info-item post-wordcount">
                <i class="icon fas fa-file-word"></i>&nbsp;<span>6.4k å­—</span>
            </span>
        
        
            <span class="meta-info-item post-min2read">
                <i class="icon fas fa-clock"></i>&nbsp;<span>28 åˆ†é’Ÿ</span>
            </span>
        
        
            <span class="meta-info-item post-pv">
                <i class="icon fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
            </span>
        
    </div>

    
</div>

                            </div>
                        </div>
                    </div>
                

                <div class="post-content keep-markdown-body ">
                    

                    
                         <h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™ç¯‡æ–‡ç« åœ¨å‰é¢å·²ç»æ˜¯åŸ‹äº†è®¸å¤šå‘äº†ï¼Œé åçš„å‡ ç¯‡æ–‡ç« éƒ½æåˆ°äº†æˆ‘æƒ³å­¦<code>syzkaller</code>ï¼Œä½†æ˜¯æ€»æœ‰äº‹è€½æä»¥è‡³äºæ‹–åˆ°äº†ç°åœ¨ã€‚æœ¬æ¥æ²¡æœ‰æ‰“ç®—å°†åŸºæœ¬çš„ä½¿ç”¨æ–¹æ³•å†™æˆæ–‡ç« çš„ï¼Œä½†æ˜¯å°±æ˜¯å‰é¢çš„å‘è¿‡å¤šï¼Œå¦‚æœä¸å†™å‡ºæ¥çš„è¯å°±ä¼šè§‰å¾—å¿ƒé‡Œè†ˆåº”ã€‚è¿™ä¸€ç¯‡ä¸ä¼šæ¶‰åŠåˆ°<code>syzkaller</code>çš„å®ç°åŸç†ï¼Œåªèƒ½é»˜é»˜ç¥ˆç¥·ä¸ä¼šå¤ªæ°´ã€‚</p>
<p>ä¸€æ ·çš„ï¼Œè¿™é‡Œä¹Ÿå°±ä¸å¤šæå¦‚ä½•ç¼–è¯‘äº†ï¼Œç½‘ä¸Šçš„èµ„æ–™å¾ˆå¤šã€‚</p>
<h2 id="syzkallerä½¿ç”¨"><a href="#syzkallerä½¿ç”¨" class="headerlink" title="syzkallerä½¿ç”¨"></a>syzkallerä½¿ç”¨</h2><h3 id="å·¥ä½œåŸç†"><a href="#å·¥ä½œåŸç†" class="headerlink" title="å·¥ä½œåŸç†"></a>å·¥ä½œåŸç†</h3><p><img   src="/images/LxNvdhpEX2sBjYc.png" ></p>
<p>ç»å¸¸çœ‹æˆ‘æ–‡ç« çš„æœ‹å‹æˆ–è®¸çœ‹å‡ºæ¥äº†ï¼Œæˆ‘ä¸æ˜¯å¾ˆæ„¿æ„å°†å›¾ç‰‡ä¸Šåˆ°åšå®¢ï¼Œä¸»è¦åŸå› è¿˜æ˜¯æˆ‘æ²¡æœ‰ä½¿ç”¨å›¾åºŠæ‰€ä»¥å°½é‡å°‘çš„ä¸Šä¼ å›¾ç‰‡ï¼Œæ‰€ä»¥æˆ‘ä¸€èˆ¬æ”¾åˆ°åšå®¢çš„å›¾ç‰‡éƒ½æ˜¯è¾ƒä¸ºæœ‰ç”¨çš„å›¾ç‰‡ã€‚</p>
<p>è¿™é‡Œç®€å•æä¸€ä¸‹ä¸Šå›¾ï¼š</p>
<p>é¦–å…ˆ<code>syz-manager</code>ä½œä¸ºçš„æ˜¯<code>syzkallmer</code>çš„æ§åˆ¶ä¸­æ¢ï¼Œå…¶ä¼šå¯åŠ¨å¤šä¸ªvmå®ä¾‹ ( å›¾ä¸­ä¸€ä¸ªé»„è‰²å¡ç‰‡ä»£è¡¨ä¸€ä¸ªå®ä¾‹ ) å¹¶è¿›è¡Œç›‘è§†ï¼ŒåŒæ—¶é€šè¿‡<code>RPC</code>å¯åŠ¨<code>syz-fuzzer</code>ã€‚</p>
<p><code>syz-fuzzer</code>è´Ÿè´£å¼•å¯¼æ•´ä¸ªfuzzçš„è¿‡ç¨‹ã€‚ç¬¬ä¸€æ­¥ï¼Œç”Ÿæˆinputã€‚ç¬¬äºŒæ­¥ï¼Œå¯åŠ¨<code>syz-executor</code>è¿›ç¨‹è¿›è¡Œfuzzã€‚ç¬¬ä¸‰æ­¥ï¼Œä»è¢«fuzzçš„å†…æ ¸çš„<code>/sys/kernel/debug/kcov</code>è·å¾—è¦†ç›– ( coverage ) ç›¸å…³ä¿¡æ¯ã€‚æœ€åï¼Œé€šè¿‡<code>RPC</code>å°†æ–°çš„è¦†ç›–é€å›<code>syz-manager</code>ã€‚</p>
<p><code>syz-executor</code>è´Ÿè´£æ‰§è¡Œå•ä¸ªè¾“å…¥ã€‚</p>
<h3 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h3><p>åœ¨æ­£å¼ä½¿ç”¨å‰æˆ‘ä»¬éœ€è¦ä¸ºå…¶é¢å¤–ç¼–å†™é…ç½®æ–‡ä»¶</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;target&quot;</span>: <span class="string">&quot;linux/amd64&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;http&quot;</span>: <span class="string">&quot;127.0.0.1:56741&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;workdir&quot;</span>: <span class="string">&quot;/media/psf/pwn/fuzz01&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;kernel_obj&quot;</span>: <span class="string">&quot;/home/parallels/linux-5.11&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;image&quot;</span>: <span class="string">&quot;/media/psf/pwn/fuzz01/bullseye.img&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;sshkey&quot;</span>: <span class="string">&quot;/media/psf/pwn/fuzz01/bullseye.id_rsa&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;syzkaller&quot;</span>: <span class="string">&quot;/home/parallels/fuzz/gopath/syzkaller&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;procs&quot;</span>: <span class="number">8</span>,</span><br><span class="line">    <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;qemu&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;vm&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;count&quot;</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">&quot;kernel&quot;</span>: <span class="string">&quot;/media/psf/pwn/fuzz01/bzImage&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;cpu&quot;</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">&quot;mem&quot;</span>: <span class="number">2048</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>$&#123;WORKDIR&#125;</code>æ˜¯éœ€è¦æ›¿æ¢ä¸ºæ‰€éœ€çš„å·¥ä½œç›®å½•ï¼Œä¹‹åç”Ÿæˆçš„crashæ–‡ä»¶å°†ä¼šä½äºå…¶ä¸­ã€‚<code>$&#123;LINUX&#125;</code>ä¸ºLinuxæºç ç›®å½•ã€‚<code>$&#123;IMAGE&#125;</code>ä¸ºæ–¹æ‰åˆ¶ä½œçš„ç³»ç»Ÿé•œåƒä¸å¯†é’¥æ–‡ä»¶ç›®å½•ã€‚<code>$&#123;GOPATH&#125;</code>æ›¿æ¢ä¸ºå®‰è£…Syzkalleræ‰€ä½¿ç”¨çš„GOPATHã€‚</p>
<h3 id="å¯åŠ¨syzkaller"><a href="#å¯åŠ¨syzkaller" class="headerlink" title="å¯åŠ¨syzkaller"></a>å¯åŠ¨syzkaller</h3><p>å¯åŠ¨å°±å¾ˆç®€å•äº†ï¼Œç›´æ¥è¾“å…¥</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/syz-manager -config=config.json <span class="comment"># config.jsonä¸ºå‰é¢æåˆ°çš„é…ç½®æ–‡ä»¶</span></span><br></pre></td></tr></table></figure>

<p>å¯åŠ¨æˆåŠŸåé€šè¿‡è®¿é—®<code>localhost:56741</code>å³å¯è·å–åˆ°<code>syzkaller</code>çš„çŠ¶æ€</p>
<h2 id="syzlangç¼–å†™æŒ‡å—"><a href="#syzlangç¼–å†™æŒ‡å—" class="headerlink" title="syzlangç¼–å†™æŒ‡å—"></a>syzlangç¼–å†™æŒ‡å—</h2><p>å¦‚æœåªæ˜¯ä¸Šè¿°æµç¨‹ä¸­é‚£æ ·ä¸€ç›´æŒ‚ç€å¯ä»¥å‡ºæ´çš„è¯ï¼Œå¤§å…¬å¸çš„æœåŠ¡å™¨å¯æ¯”æˆ‘è¿™ç”µè„‘å¥½å¾—ä¸çŸ¥é“å“ªå»äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦äººå·¥é…ç½®ç³»ç»Ÿè°ƒç”¨æ¨¡æ¿ï¼Œä»¥æœ‰é’ˆå¯¹æ€§çš„è¿›è¡Œæ¼æ´æŒ–æ˜ã€‚</p>
<p>syzkaller ä½¿ç”¨å®ƒè‡ªå·±çš„å£°æ˜å¼è¯­è¨€æ¥æè¿°ç³»ç»Ÿè°ƒç”¨æ¨¡æ¿ï¼Œåœ¨å®‰è£…ç›®å½•ä¸‹çš„ <code>docs/syscall_descriptions.md</code> ä¸ <code>docs/syscall_descriptions_syntax.md</code> ä¸­æœ‰ç€ç›¸å…³çš„è¯´æ˜ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦ä½¿ç”¨ syzlang æ¥ç¼–å†™ç‰¹å®šçš„ç³»ç»Ÿè°ƒç”¨æè¿°æ–‡ä»¶ï¼ˆä¹Ÿå«è§„åˆ™æ–‡ä»¶ï¼‰ï¼Œsyzkaller ä¼šæ ¹æ®æˆ‘ä»¬çš„æè¿°æ–‡ä»¶æœ‰é’ˆå¯¹æ€§åœ°è¿›è¡Œ fuzzã€‚</p>
<h3 id="syzlangè¯­æ³•"><a href="#syzlangè¯­æ³•" class="headerlink" title="syzlangè¯­æ³•"></a>syzlangè¯­æ³•</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">syscallname <span class="string">&quot;(&quot;</span> [arg [<span class="string">&quot;,&quot;</span> arg]*] <span class="string">&quot;)&quot;</span> [type] [<span class="string">&quot;(&quot;</span> attribute* <span class="string">&quot;)&quot;</span>]</span><br><span class="line">arg = argname type</span><br><span class="line">argname = identifier</span><br><span class="line">type = <span class="keyword">typename</span> [ <span class="string">&quot;[&quot;</span> type-options <span class="string">&quot;]&quot;</span> ]</span><br><span class="line"><span class="keyword">typename</span> = <span class="string">&quot;const&quot;</span> | <span class="string">&quot;intN&quot;</span> | <span class="string">&quot;intptr&quot;</span> | <span class="string">&quot;flags&quot;</span> | <span class="string">&quot;array&quot;</span> | <span class="string">&quot;ptr&quot;</span> |</span><br><span class="line">	   <span class="string">&quot;string&quot;</span> | <span class="string">&quot;strconst&quot;</span> | <span class="string">&quot;filename&quot;</span> | <span class="string">&quot;glob&quot;</span> | <span class="string">&quot;len&quot;</span> |</span><br><span class="line">	   <span class="string">&quot;bytesize&quot;</span> | <span class="string">&quot;bytesizeN&quot;</span> | <span class="string">&quot;bitsize&quot;</span> | <span class="string">&quot;vma&quot;</span> | <span class="string">&quot;proc&quot;</span></span><br><span class="line">type-options = [type-opt [<span class="string">&quot;,&quot;</span> type-opt]]</span><br></pre></td></tr></table></figure>

<p>ä¸Šè¿°å³æ˜¯<code>syzlang</code>çš„è¯­æ³•ç»“æ„ï¼Œè¿™ç®€å•ä»‹ç»ä¸€ä¸‹ä¸Šé¢ç¬¦å·çš„å«ä¹‰ã€‚</p>
<blockquote>
<p><code>&quot;&quot;</code> è¡¨ç¤ºè¿™ä¸ªç¬¦å·å†…çš„å†…å®¹åº”æŒ‰ç…§å…¶åŸæ ·è¿›è¡ŒåŒ¹é…</p>
<p><code>|</code>   è¡¨ç¤ºçš„å«ä¹‰å¤§å·®ä¸å·®ï¼Œæ„å‘³å–å·¦å³ä¸¤è¾¹çš†å¯</p>
<p><code>=</code>   è¡¨ç¤ºå·¦è¾¹çš„è¡¨è¾¾å¼åº”ä¸ºå³è¾¹çš„å½¢å¼</p>
<p><code>[]</code> è¡¨ç¤ºå–å…¶å†…éƒ¨çš„ä¸€ä¸ªå€¼</p>
<p><code>*</code>   è¡¨ç¤ºå’Œæ­£åˆ™ä¸€æ ·ï¼Œå³ä¸º0ä¸ªæˆ–å¤šä¸ª</p>
</blockquote>
<p>æ‰€ä»¥å…¶å†™æ³•ä¸ºï¼Œ<code>syscallname</code> + å¤šä¸ª<code>arg</code>ç»„æˆã€‚<code>arg</code>ç”±æ ‡è¯†ç¬¦<code>identifier</code>ä¸æ“ä½œç±»å‹<code>type</code>æ„æˆã€‚<code>type</code>ç”±æ“ä½œç±»å‹å<code>typename</code>ä»¥åŠå¯¹åº”ç±»å‹çš„ç±»å‹é€‰æ‹©<code>type-options</code>ç»„æˆï¼Œæœ€åæ ¹æ®<code>typename</code>çš„ä¸åŒï¼Œ<code>type-options</code>è·Ÿä¸€ä¸ªæˆ–ä¸¤ä¸ª<code>type-opt</code>ã€‚</p>
<p>æ ¹æ®ä¸Šè¿°è§„åˆ™å¯ä»¥å¾ˆè½»æ¾çš„ç†è§£Googleå®˜æ–¹æä¾›çš„ä¸€ä¸ªæ¨¡æ¿</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">open(file filename, flags flags[open_flags], mode flags[open_mode]) <span class="function">fd</span></span><br><span class="line"><span class="function"><span class="title">read</span><span class="params">(fd fd, buf buffer[out], count len[buf])</span></span></span><br><span class="line"><span class="function"><span class="title">close</span><span class="params">(fd fd)</span></span></span><br><span class="line"><span class="function">open_mode </span>= S_IRUSR, S_IWUSR, S_IXUSR, S_IRGRP, S_IWGRP, S_IXGRP, S_IROTH, S_IWOTH, S_IXOTH</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæ³¨é‡Šçš„å†™æ³•å°±å’Œ<code>python</code>ä¸€æ ·</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># aaaa</span></span><br></pre></td></tr></table></figure>

<p>æ–‡ä»¶åŒ…å«çš„å†™æ³•åŸºæœ¬å°±å’ŒCä¸€æ ·</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">include&lt;linux/fs.h&gt;</span><br></pre></td></tr></table></figure>

<h3 id="å‚æ•°"><a href="#å‚æ•°" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h3><p>å‰é¢ä¸­æåˆ°äº†å‚æ•°çš„å½¢å¼</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arg = argname + type</span><br></pre></td></tr></table></figure>

<p>å…¶æœ‰ä¸€ä¸ªå‚æ•°ååŠ ä¸€ä¸ªæ“ä½œç±»å‹æ„æˆã€‚ä¸‹é¢æ ¹æ®ä¾‹å­è¯¦ç»†è®²ä¸€ä¸‹</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SYSCALL_DEFINE3(read, <span class="keyword">unsigned</span> <span class="keyword">int</span>, fd, <span class="keyword">char</span> __user *, buf, <span class="keyword">size_t</span>, count)</span><br></pre></td></tr></table></figure>

<p>ä¸Šè¿°æ˜¯å†…æ ¸ä¸­readç³»ç»Ÿè°ƒç”¨çš„å£°æ˜ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨ libc çš„ wrapper è¿›è¡Œ read ç³»ç»Ÿè°ƒç”¨æ—¶ï¼Œå½¢å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> 	my_file_fd = open(<span class="string">&quot;/dev/test&quot;</span>, O_RDONLY);</span><br><span class="line"><span class="keyword">char</span> 			my_buf[<span class="number">114514</span>];</span><br><span class="line"><span class="keyword">size_t</span>			my_count = <span class="number">114514</span>;</span><br><span class="line">read(my_file_fd, my_buf, my_count);</span><br></pre></td></tr></table></figure>

<p>åœ¨ä¸Šè¿°ä¾‹å­ä¸­<code>fdã€bufã€count</code>å³ä¸º<code>argname</code>ï¼Œ<code>my_file_fdã€my_bufã€my_count</code>å³ä¸º<code>type</code></p>
<p>é‚£ä¹ˆåœ¨<code>syzlang</code>ç¼–å†™ç³»ç»Ÿè°ƒç”¨æ—¶å°±åº”è¯¥å†™ä¸º<code>fd my_file_fd</code>ã€‚( è¿™é‡Œå‡è®¾<code>my_file_fd</code>å·²å®šä¹‰ä¸º<code>resources</code> )</p>
<h3 id="ç±»å‹"><a href="#ç±»å‹" class="headerlink" title="ç±»å‹"></a>ç±»å‹</h3><p>å‰é¢æåˆ°äº†<code>arg</code>æ˜¯ç”±<code>argname type</code>æ„æˆï¼Œä¹Ÿæåˆ°äº†<code>type</code>æ˜¯ç”±<code>typename type-options</code>æ„æˆã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">type = <span class="keyword">typename</span> [ <span class="string">&quot;[&quot;</span> type-options <span class="string">&quot;]&quot;</span> ]</span><br></pre></td></tr></table></figure>

<p>é¦–å…ˆè¿™é‡Œè¯¦ç»†æä¸€ä¸‹ç±»å‹åï¼Œå³è¯¥ type çš„ç±»å‹ï¼Œä¾‹å¦‚ C å½“ä¸­çš„intã€charã€void ç­‰ç­‰ã€‚</p>
<p>å¸¸è§„çš„ç±»å‹ååŒ…æ‹¬ï¼š( <del>ç›´æ¥æ¬ï¼</del>)</p>
<ul>
<li><strong>opt</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼ˆä¾‹å¦‚ mmap çš„ fdï¼‰</li>
</ul>
<p>å…¶ä½™ type-options æ˜¯åŸºäºç‰¹å®š type çš„ï¼Œå¦‚ä¸‹ï¼š</p>
<ul>
<li><strong>const</strong>ï¼šæ•´å‹å¸¸æ•°<ul>
<li>ç±»å‹é€‰é¡¹ï¼š<ul>
<li>å€¼ï¼ˆvalueï¼‰ï¼šä¾‹å¦‚ <code>0</code></li>
<li>åŸºç¡€ç±»å‹ï¼ˆunderlying typeï¼‰ï¼š<code>intN</code> æˆ– <code>intptr</code> ä¹‹ä¸€</li>
</ul>
</li>
</ul>
</li>
<li><strong>intN</strong> æˆ– <strong>intptr</strong>ï¼šä¸€ä¸ªæœ‰ç€ç‰¹æ®Šå«ä¹‰çš„æ•´å‹ï¼Œä¸‹æ–‡ä¼šè¿›è¡Œè¯¦ç»†è¯´æ˜<ul>
<li>ç±»å‹é€‰é¡¹ï¼š<ul>
<li>å¯é€‰èŒƒå›´åŒºé—´ï¼šä¾‹å¦‚ <code>&quot;1:100&quot;</code> è¡¨ç¤ºå–å€¼å€¼çš„åŒºé—´ä¸º <code>[1, 100]</code></li>
<li>å¯é€‰å‚æ•°</li>
</ul>
</li>
</ul>
</li>
<li><strong>flags</strong>ï¼šå€¼çš„é›†åˆ<ul>
<li>ç±»å‹é€‰é¡¹ï¼š<ul>
<li>å¯¹ flags æè¿°çš„å¼•ç”¨</li>
<li>åŸºç¡€æ•´å‹ç±»å‹ï¼šä¾‹å¦‚ <code>int32</code></li>
</ul>
</li>
</ul>
</li>
<li><strong>array</strong>ï¼šä¸€ä¸ªå¯å˜é•¿&#x2F;å›ºå®šé•¿åº¦çš„æ•°ç»„<ul>
<li>ç±»å‹é€‰é¡¹ï¼š<ul>
<li>å…ƒç´ çš„ type</li>
<li>å¯é€‰é•¿åº¦åŒºé—´ï¼šä¾‹å¦‚å›ºå®šé•¿åº¦ <code>&quot;5&quot;</code> æˆ–è€…é•¿åº¦èŒƒå›´ <code>&quot;5:10&quot;</code>ï¼ˆåŒ…æ‹¬è¾¹ç•Œï¼‰</li>
</ul>
</li>
</ul>
</li>
<li><strong>ptr</strong> æˆ– <strong>ptr64</strong>ï¼šæŒ‡å‘ä¸€ä¸ªå¯¹è±¡çš„æŒ‡é’ˆ<ul>
<li>ç±»å‹é€‰é¡¹ï¼š<ul>
<li>æ–¹å‘ï¼š<code>in</code> æˆ– <code>out</code> æˆ– <code>inout</code></li>
<li>å¯¹è±¡çš„ type</li>
</ul>
</li>
<li>æ— è®ºå¯¹è±¡æŒ‡é’ˆå¤§å°å¦‚ä½•ï¼Œptr64 æ°¸è¿œä¸º 8 å­—èŠ‚</li>
</ul>
</li>
<li><strong>string</strong>ï¼šä¸€å—æœ‰ç€ 0 ç»ˆæ­¢ç¬¦çš„å†…å­˜ç¼“å†²åŒº<ul>
<li>ç±»å‹é€‰é¡¹ï¼š<ul>
<li>å¸¸é‡å­—ç¬¦ä¸²&#x2F;å¯¹å­—ç¬¦ä¸²çš„å¼•ç”¨<ul>
<li>å‰è€…ï¼šä¾‹å¦‚ <code>&quot;foo&quot;</code>ä½œä¸ºå¸¸è§„å­—ç¬¦ä¸²è¿›è¡Œè§£æï¼Œæˆ–è€…<code>deadbeef</code>ä½œä¸º4ä¸ª 16 è¿›åˆ¶å­—èŠ‚è¿›è¡Œè§£æ</li>
<li>åè€…ï¼šè‹¥æ˜¯ç‰¹æ®Šç±»å‹ <code>filename</code> åˆ™ä¼š<strong>ç”Ÿæˆ</strong>æ–‡ä»¶å</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><strong>stringnoz</strong>ï¼šä¸€å—<strong>æ²¡æœ‰</strong> 0 ç»ˆæ­¢ç¬¦çš„å†…å­˜ç¼“å†²åŒº<ul>
<li>ç±»å‹é€‰é¡¹ï¼šï¼ˆåŒ <code>string</code>)</li>
</ul>
</li>
<li><strong>glob</strong>ï¼šåŒ¹é…ç›®æ ‡æ–‡ä»¶çš„ globï¼ˆï¼Ÿï¼‰æ¨¡å¼<ul>
<li>ç±»å‹é€‰é¡¹ï¼š<ul>
<li>ç”¨å¼•å·åŒ…è£¹ç€çš„æ¨¡å¼å­—ç¬¦ä¸²ï¼šä¾‹å¦‚ <code>&quot;/sys/&quot;</code> æˆ– <code>&quot;/sys/**/*/&quot;</code>ï¼Œå…·ä½“ç”¨æ³•å‚è§<a class="link"   target="_blank" rel="noopener" href="https://pkg.go.dev/path/filepath#Match" >https://pkg.go.dev/path/filepath#Match<i class="fas fa-external-link-alt"></i></a></li>
</ul>
</li>
</ul>
</li>
<li><strong>fmt</strong>ï¼šä¸€ä¸ªè¡¨ç¤ºä¸€ä¸ªæ•´æ•°çš„å­—ç¬¦ä¸²<ul>
<li>ç±»å‹é€‰é¡¹ï¼š<ul>
<li>æ ¼å¼ä¸å€¼ï¼šå‰è€…å¯å–å€¼ä¸º <code>dec</code>æˆ– <code>hex</code> æˆ– <code>oct</code>ï¼›åè€…å¯ä»¥æ˜¯ä¸€ä¸ª resourceã€intã€flagsã€const æˆ– proc</li>
</ul>
</li>
<li>æœ€ç»ˆçš„ç»“æœé€šå¸¸æ˜¯å›ºå®šå°ºå¯¸çš„</li>
</ul>
</li>
<li><strong>len</strong>ï¼šå¦ä¸€ä¸ª <code>å­—æ®µ</code> çš„é•¿åº¦ï¼ˆå¯¹äº array è€Œè¨€ä¸ºå…ƒç´ çš„æ•°é‡ï¼‰<ul>
<li>ç±»å‹é€‰é¡¹ï¼š<ul>
<li>å¯¹è±¡çš„ argname</li>
</ul>
</li>
</ul>
</li>
<li><strong>bytesize</strong>ï¼šä¸ len ç±»ä¼¼ï¼Œä¸è¿‡å•ä½æ˜¯<strong>å­—èŠ‚</strong><ul>
<li>ç±»å‹é€‰é¡¹ï¼š<ul>
<li>å¯¹è±¡çš„ argname</li>
</ul>
</li>
</ul>
</li>
<li><strong>bitsize</strong>ï¼šä¸ len ç±»å‹ï¼Œä¸è¿‡å•ä½æ˜¯<strong>æ¯”ç‰¹ä½</strong><ul>
<li>ç±»å‹é€‰é¡¹ï¼š<ul>
<li>å¯¹è±¡çš„ argname</li>
</ul>
</li>
</ul>
</li>
<li><strong>offsetof</strong>ï¼šä¸€ä¸ª <code>å­—æ®µ</code> åœ¨å…¶ parent struct ä¸­çš„åç§»<ul>
<li>ç±»å‹é€‰é¡¹ï¼š<ul>
<li><code>å­—æ®µ</code></li>
</ul>
</li>
</ul>
</li>
<li><strong>vma</strong> æˆ– <strong>vma64</strong>ï¼šæŒ‡å‘ä¸€ç»„é¡µçš„æŒ‡é’ˆï¼ˆç”¨ä½œ mmap&#x2F;munmap&#x2F;mremap&#x2F;madvise çš„è¾“å…¥ï¼‰<ul>
<li>ç±»å‹é€‰é¡¹ï¼š<ul>
<li>ï¼ˆå¯é€‰ï¼‰é¡µçš„æ•°é‡æˆ–é¡µçš„èŒƒå›´ï¼šå‰è€…ä¾‹å¦‚ <code>vma[7]</code>ï¼Œåè€…ä¾‹å¦‚ <code>vma[2-4]</code></li>
</ul>
</li>
<li>vma64 çš„é•¿åº¦æ’ä¸º 8 å­—èŠ‚</li>
</ul>
</li>
<li><strong>proc</strong>ï¼šå•ä¸ªè¿›ç¨‹çš„æ•´å‹ï¼ˆè¯¦è§ä¸‹é¢çš„æè¿°ï¼‰<ul>
<li>ç±»å‹é€‰é¡¹ï¼š<ul>
<li>å€¼çš„åŒºé—´çš„èµ·å§‹</li>
<li>æ¯ä¸ªè¿›ç¨‹çš„å€¼çš„æ•°é‡</li>
<li>åŸºç¡€ç±»å‹</li>
</ul>
</li>
</ul>
</li>
<li><strong>text</strong>ï¼šç‰¹å®š type çš„æœºå™¨ç <ul>
<li>ç±»å‹é€‰é¡¹ï¼š<ul>
<li>ä»£ç ç±»å‹ï¼š<code>x86_real</code>, <code>x86_16</code>, <code>x86_32</code>, <code>x86_64</code>, <code>arm64</code></li>
</ul>
</li>
</ul>
</li>
<li><strong>void</strong>ï¼štype with static size 0<ul>
<li>é€šå¸¸åœ¨æ¨¡æ¿ä»¥åŠå¯å˜é•¿ï¼ˆvarlenï¼‰è”åˆä½“ä¸­ä½¿ç”¨ï¼Œ<strong>ä¸èƒ½ç”¨ä½œç³»ç»Ÿè°ƒç”¨çš„å‚æ•°</strong></li>
</ul>
</li>
</ul>
<p>åœ¨ <code>ç»“æ„ä½“/è”åˆä½“/æŒ‡é’ˆ</code> ä¸­ä½¿ç”¨æ—¶ï¼Œ<code>flags/len/flags</code> çš„æ„æˆä¸­å°¾éƒ¨è¿˜å¯ä»¥è·Ÿç€ type type-options</p>
<p>æ¥ç€æä¸€ä¸‹ç±»å‹é€‰é¡¹</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">type-options = [type-opt [<span class="string">&quot;,&quot;</span> type-opt]]</span><br></pre></td></tr></table></figure>

<p>å½¢å¼å¦‚ä¸Šï¼Œä»ä¸€å¼€å§‹çš„è¯­æ³•è§„åˆ™æ¥çœ‹<code>type-options</code>å¯¹äº<code>type</code>å³ä¸ºå¯é€‰é¡¹ï¼Œä¹Ÿå¯ä»¥åŒæ—¶æ‹¥æœ‰å¤šä¸ª<code>type-options</code>ï¼ŒåŒæ ·æ ¹æ®å‰é¢çš„è¯­æ³•è§„åˆ™å¯ä»¥çœ‹å‡ºæ¥è¦ä½¿ç”¨<code>type-options</code>æ˜¯åº”å¦‚ä¸‹ä¾‹ä¸€æ ·</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flags flags[open_flags]</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢è¿™ä¸ªä¾‹å­çš„è§£æï¼Œæˆ‘ä»¬è¿™ä¸ªå‚æ•°åä¸º<code>flags</code>å‚æ•°ï¼Œè¾“å…¥çš„ç±»å‹ä¸º<code>flags</code>ï¼Œå…¶ç±»å‹é€‰é¡¹ä¸ºå¯¹ä¸€ä¸ª<code>flags</code>æè¿°<code>open_flags</code>çš„åº”ç”¨ï¼Œå³ä¸ºå–<code>open_flags</code>ä¸­çš„å€¼ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">open_flags = O_WRONLY, O_RDWR, O_APPEND, FASYNC, O_CLOEXEC, O_CREAT, O_DIRECT, O_DIRECTORY, O_EXCL, O_LARGEFILE, O_NOATIME, O_NOCTTY, O_NOFOLLOW, O_NONBLOCK, O_PATH, O_SYNC, O_TRUNC, __O_TMPFILE</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­çš„<code>open_flags</code>å®šä¹‰çš„å†…å®¹å¦‚ä¸Šï¼Œè¿™äº›å€¼å¯ä»¥é€šè¿‡<code>include</code>è¯­å¥ä»å†…æ ¸æºç ä¸­è¢«åŒ…å«è¿›æ¥ã€‚</p>
<h3 id="ç³»ç»Ÿè°ƒç”¨"><a href="#ç³»ç»Ÿè°ƒç”¨" class="headerlink" title="ç³»ç»Ÿè°ƒç”¨"></a>ç³»ç»Ÿè°ƒç”¨</h3><p>åœ¨å‰é¢æåˆ°äº†ç³»ç»Ÿè°ƒç”¨çš„æ¨¡æ¿å¦‚ä¸‹</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">syscallname <span class="string">&quot;(&quot;</span> [arg [<span class="string">&quot;,&quot;</span> arg]*] <span class="string">&quot;)&quot;</span> [type] [<span class="string">&quot;(&quot;</span> attribute* <span class="string">&quot;)&quot;</span>]</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­é™¤äº†<code>attribute</code>éƒ½å·²ç»åšè¿‡ä¸€å®šè§£é‡Šäº†ï¼Œè¿™é‡Œåœ¨å¯¹å…¶åšåˆ†è§£åˆ†æã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">open(file ptr[in, filename], flags flags[open_flags], mode flags[open_mode])</span><br><span class="line"></span><br><span class="line">open_flags = O_WRONLY, O_RDWR, O_APPEND, FASYNC, O_CLOEXEC, O_CREAT, O_DIRECT, O_DIRECTORY, O_EXCL, O_LARGEFILE, O_NOATIME, O_NOCTTY, O_NOFOLLOW, O_NONBLOCK, O_PATH, O_SYNC, O_TRUNC, __O_TMPFILE</span><br><span class="line">open_mode = S_IRUSR, S_IWUSR, S_IXUSR, S_IRGRP, S_IWGRP, S_IXGRP, S_IROTH, S_IWOTH, S_IXOTH</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå¯¹<code>open</code>ç³»ç»Ÿè°ƒç”¨ï¼Œå­˜åœ¨ä»¥ä¸‹ä¸‰ä¸ªè¾“å…¥ï¼š</p>
<ul>
<li>file å‚æ•°ï¼šä¸€ä¸ªæŒ‡é’ˆç±»å‹ï¼Œå…¶ type-opetions çš„ç¬¬ä¸€ä¸ªä¸º <code>in</code>ï¼Œæ„ä¸ºç”±è¯¥æŒ‡é’ˆæŒ‡å‘ç‰¹å®šå¯¹è±¡ï¼Œç¬¬äºŒä¸ªä¸º <code>filename</code>ï¼Œä¸ºç‰¹æ®Šçš„ string å¯¹è±¡ï¼Œå¯¹äº filenameï¼Œsyzlang ä¼šè¿›è¡Œæ–‡ä»¶ç”Ÿæˆï¼Œå°†æ–‡ä»¶åä½œä¸ºè¾“å…¥</li>
<li>flags å‚æ•°ï¼šä¸€ä¸ª flagsç±»å‹ï¼Œå…¶ <code>type-options</code> ä¸º <code>open_flags</code> ï¼Œæ„ä¸ºä»æˆ‘ä»¬å®šä¹‰çš„ flagsâ€”â€”<code>open_flags</code> ä¸­å–å€¼</li>
<li>mode å‚æ•°ï¼šä¸€ä¸ªflagsç±»å‹ï¼Œå…¶ <code>type-options</code> ä¸º <code>open_mode</code> ï¼Œæ„ä¸ºä»æˆ‘ä»¬å®šä¹‰çš„ flagsâ€”â€”<code>open_mode</code> ä¸­å–å€¼</li>
</ul>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œç³»ç»Ÿè°ƒç”¨éƒ½ä¼šå­˜åœ¨è¿”å›å€¼ï¼Œåœ¨<code>syzlang</code>ä¸­å¯ä»¥å¿½ç•¥æ‰è¿”å›å€¼ä¹Ÿå¯ä»¥é€‰æ‹©æ¥æ”¶ï¼Œå¦‚æœé€‰æ‹©æ¥æ”¶åˆ™åº”å½¢å¦‚ä¸Šå¼åœ¨ç³»ç»Ÿè°ƒç”¨åé¢åŠ ä¸Šä¸€ä¸ª<code>type</code>ï¼Œä¾‹å¦‚<code>open</code>ç³»ç»Ÿè°ƒç”¨ä¼šè¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œè‹¥æ˜¯æˆ‘ä»¬åƒå°†å…¶è¿”å›çš„çš„æ–‡ä»¶æè¿°ç¬¦å­˜åˆ°ä¸€ä¸ªå˜é‡ä¸­å¦‚<code>test_fd</code>ï¼Œæˆ‘ä»¬åº”å½“å†™æˆå¦‚ä¸‹å½¢å¼ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">open(file ptr[in, filename], flags flags[open_flags], mode flags[open_mode]) test_fd</span><br><span class="line"></span><br><span class="line">open_flags = O_WRONLY, O_RDWR, O_APPEND, FASYNC, O_CLOEXEC, O_CREAT, O_DIRECT, O_DIRECTORY, O_EXCL, O_LARGEFILE, O_NOATIME, O_NOCTTY, O_NOFOLLOW, O_NONBLOCK, O_PATH, O_SYNC, O_TRUNC, __O_TMPFILE</span><br><span class="line">open_mode = S_IRUSR, S_IWUSR, S_IXUSR, S_IRGRP, S_IWGRP, S_IXGRP, S_IROTH, S_IWOTH, S_IXOTH</span><br></pre></td></tr></table></figure>

<p>æ—¢ç„¶æ–‡ä»¶æè¿°ç¬¦ä¸­å·²ç»å­˜åœ¨æˆ‘ä»¬çš„å˜é‡ï¼Œé‚£ä¹ˆåœ¨åç»­ä¹Ÿæ˜¯å¯ä»¥ç»§ç»­ä½¿ç”¨çš„ï¼Œå¦‚ä¸‹:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">close(fd test_fd)</span><br></pre></td></tr></table></figure>

<p>éšåå°±æ˜¯å‰é¢æåˆ°çš„ï¼Œåœ¨<code>type</code>åè¿˜æœ‰ä¸€ä¸ªå¯é€‰å‚æ•°<code>attribute</code>ï¼Œå…¶æœ‰ä»¥ä¸‹å¯é€‰å€¼ï¼š</p>
<ul>
<li><code>disabled</code>ï¼šè¯¥ç³»ç»Ÿè°ƒç”¨å°†ä¸ç”¨äº fuzzingï¼›è¿™ä¸ªå±æ€§é€šå¸¸ç”¨äºä¸´æ—¶ç¦ç”¨æŸäº›ç³»ç»Ÿè°ƒç”¨ï¼Œæˆ–è€…ç¦ç”¨ç‰¹å®šçš„å‚æ•°ç»„åˆ</li>
<li><code>timeout[N]</code>ï¼šç³»ç»Ÿè°ƒç”¨åœ¨é»˜è®¤å€¼ä»¥å¤–çš„é¢å¤–çš„è¶…æ—¶æ—¶é—´ï¼Œå•ä½ä¸ºæ¯«ç§’ï¼ˆmsï¼‰</li>
<li><code>prog_timeoout[N]</code>ï¼šè‹¥ä¸€ä¸ªç¨‹åºåŒ…å«äº†è¯¥ç³»ç»Ÿè°ƒç”¨ï¼Œåˆ™è¯¥å±æ€§ä¸ºæ•´ä¸ªç¨‹åºçš„æ‰§è¡Œçš„è¶…æ—¶æ—¶é—´ï¼Œè‹¥å­˜åœ¨å¤šä¸ªå®šä¹‰äº†è¯¥å±æ€§çš„ç³»ç»Ÿè°ƒç”¨åˆ™å–æœ€å¤§å€¼</li>
<li><code>ignore_return</code>ï¼šåœ¨å›é€€åé¦ˆä¸­å¿½è§†è¿™ä¸ªç³»ç»Ÿè°ƒç”¨çš„è¿”å›å€¼ï¼›ç”¨äºä¸è¿”å›å›ºå®šçš„é”™è¯¯ç ï¼ˆä¾‹å¦‚ -EFAULTï¼‰è€Œæ˜¯è¿”å›å…¶ä»–å€¼çš„ç³»ç»Ÿè°ƒç”¨</li>
<li><code>break_returns</code>ï¼šå¿½ç•¥å›é€€åé¦ˆä¸­ç¨‹åºä¸­æ‰€æœ‰åç»­ç³»ç»Ÿè°ƒç”¨çš„è¿”å›å€¼</li>
</ul>
<p>æ¥ç€å°±æ˜¯ç³»ç»Ÿè°ƒç”¨çš„å˜ç§ï¼ˆvariantsï¼‰å¯ä»¥åœ¨ç³»ç»Ÿè°ƒç”¨ååé¢ä½¿ç”¨ <code>$</code> ç¬¦å·è¿›è¡Œé¢å¤–çš„æŒ‡å®š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">socket$inet_tcp(domain <span class="keyword">const</span>[AF_INET], type <span class="keyword">const</span>[SOCK_STREAM], proto <span class="keyword">const</span>[<span class="number">0</span>]) sock_tcp</span><br><span class="line">socket$inet_udp(domain <span class="keyword">const</span>[AF_INET], type <span class="keyword">const</span>[SOCK_DGRAM], proto <span class="keyword">const</span>[<span class="number">0</span>]) sock_udp</span><br></pre></td></tr></table></figure>

<p>ä¾‹å¦‚socketç³»ç»Ÿè°ƒç”¨å¯ä»¥ç”¨äºåˆ›å»ºå¾ˆå¤šç±»å‹çš„socketï¼Œä¸Šè¿°å®šä¹‰äº†ä¸¤ç§ä¸åŒçš„å˜ä½“ã€‚è€Œå˜ç§çš„ä½œç”¨ä¸»è¦æ˜¯åŒºåˆ†syscallï¼Œç±»ä¼¼äºåˆ«åçš„æ•ˆæœã€‚</p>
<h3 id="æ•´å‹"><a href="#æ•´å‹" class="headerlink" title="æ•´å‹"></a>æ•´å‹</h3><p>æ•´å‹ä¹Ÿæ˜¯ä¸€ç§ typeï¼Œå…¶å¯é€‰é¡¹ä¸º <code>int8</code> ã€<code>int16</code>ã€<code>int32</code>ã€<code>int64</code>ï¼Œè¡¨ç¤ºç›¸åº”å¤§å°çš„æ•´å‹ï¼Œ<code>intptr</code> ç”¨ä»¥è¡¨ç¤ºä¸€ä¸ª<strong>æŒ‡é’ˆå¤§å°</strong>çš„æ•´å‹ï¼Œå¯¹åº” C è¯­è¨€ä¸­çš„ <code>long</code>ï¼Œé€šè¿‡æ·»åŠ  <code>be</code> åç¼€è¡¨ç¤ºè¿™ä¸ªæ•´å‹å­˜å‚¨ä¸ºå¤§ç«¯åºã€‚</p>
<p>å¯ä»¥ç”¨ int32[0:100] æˆ– int32[0:4096,512] çš„æ ¼å¼ä¸ºä¸€ä¸ª 512 å¯¹é½çš„ int æŒ‡å®šä¸€ä¸ªæ•´æ•°çš„å€¼èŒƒå›´ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">read$eventfd(fd fd_event, val ptr[out, int64], len len[val])</span><br></pre></td></tr></table></figure>

<h3 id="ç»“æ„ä½“"><a href="#ç»“æ„ä½“" class="headerlink" title="ç»“æ„ä½“"></a>ç»“æ„ä½“</h3><p>åœ¨<code>syzlang</code>ä¸­åŒæ ·å¯ä»¥å­˜åœ¨ç»“æ„ä½“ï¼Œè”åˆä½“è¿™ä¸€è¯´ï¼Œæ—¢ç„¶å‰é¢å·²ç»æåˆ°äº†è¿™ä¹ˆå¤šï¼Œè¿™é‡Œå°±æ”¾ä¸€ä¸ªå®ƒçš„ä¸€ä¸ªè¯­æ³•ç»“æ„</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">structname <span class="string">&quot;&#123;&quot;</span> <span class="string">&quot;\n&quot;</span></span><br><span class="line">	(fieldname type (<span class="string">&quot;(&quot;</span> fieldattribute* <span class="string">&quot;)&quot;</span>)? <span class="string">&quot;\n&quot;</span>)+</span><br><span class="line"><span class="string">&quot;&#125;&quot;</span> (<span class="string">&quot;[&quot;</span> attribute* <span class="string">&quot;]&quot;</span>)?</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹å‡ºæ¥ç»“æ„å…¶å®å’Œcçš„å¾ˆç±»ä¼¼ï¼Œå®šä¹‰ä¸€ä¸ª<code>structname</code>ï¼Œç„¶åå†…éƒ¨æˆå‘˜åŒ…å«äº†<code>fieldname / type</code>ä»¥åŠåé¢å¯ä»¥æ·»åŠ <code>(fieldattribute)</code>ï¼Œè¿™é‡Œçš„å±æ€§ä¸å‰é¢çš„æ˜¯æœ‰ä¸€å®šå·®è·çš„ï¼Œè¿™é‡Œçš„å±æ€§åªæœ‰æ–¹å‘<code>in / out / inout</code></p>
<p>æœ€åå¯ä»¥çœ‹åˆ°åœ¨ç»“æ„ä½“ç»“å°¾å¯ä»¥è¢«<code>[attribute]</code>æ¥æ·»åŠ å±æ€§ï¼Œè¿™é‡Œå­˜åœ¨ä»¥ä¸‹å±æ€§ï¼š</p>
<ul>
<li><code>packed</code>ï¼šè¯¥ç»“æ„ä½“ä¸åŒå­—æ®µä¹‹é—´æ²¡æœ‰ paddingï¼ˆä¾‹å¦‚ C ä¸­æœ‰ä¸€ä¸ªç»“æ„ä½“ <code>struct T&#123;int a; char b;&#125;;</code>ï¼Œchar ä¸º 1 å­—èŠ‚ï¼Œint ä¸º 4 å­—èŠ‚ï¼Œé‚£ä¹ˆè¯¥ç»“æ„ä½“ä¾¿ä¼šå¯¹ 4 å­—èŠ‚å¯¹é½ï¼Œåœ¨å…¶ä¸¤ä¸ªå­—æ®µä¹‹é—´å°±ä¼šæœ‰ 3 å­—èŠ‚çš„ paddingï¼‰</li>
<li><code>align[N]</code>ï¼šæŒ‡å®šè¯¥ç»“æ„ä½“å¯¹ N å­—èŠ‚å¯¹é½ï¼Œpadding çš„å†…å®¹å¹¶æœªæŒ‡å®šï¼ˆé€šå¸¸ä¸º0ï¼‰</li>
<li><code>size[N]</code>ï¼šç»“æ„ä½“è¢«å¡«å……åˆ°æŒ‡å®šçš„å¤§å° <code>N</code></li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">test_struct &#123;</span><br><span class="line">	field0	<span class="keyword">const</span>[<span class="number">1</span>, int32]	  (in)</span><br><span class="line">	<span class="function">field1	<span class="title">int32</span>         		<span class="params">(inout)</span></span></span><br><span class="line"><span class="function">	field2	<span class="title">fd</span>								<span class="params">(out)</span></span></span><br><span class="line"><span class="function">&#125; [packed]</span></span><br></pre></td></tr></table></figure>

<p>ä¸ç»“æ„ä½“ç±»ä¼¼ï¼Œè”åˆä½“çš„è¯­æ³•ç»“æ„å¦‚ä¸‹ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">unionname <span class="string">&quot;[&quot;</span> <span class="string">&quot;\n&quot;</span></span><br><span class="line">	(fieldname type (<span class="string">&quot;(&quot;</span> fieldattribute* <span class="string">&quot;)&quot;</span>)? <span class="string">&quot;\n&quot;</span>)+</span><br><span class="line"><span class="string">&quot;]&quot;</span> (<span class="string">&quot;[&quot;</span> attribute* <span class="string">&quot;]&quot;</span>)?</span><br></pre></td></tr></table></figure>

<p>ä¸å‰é¢çš„åŒºåˆ«ä¸»è¦æ˜¯æœ€åçš„<code>[attribute]</code>ä¸­çš„å¯é€‰æ€§çš„åŒºåˆ«ï¼Œè¿™é‡Œä¸»è¦æœ‰ï¼š</p>
<ul>
<li><code>varlen</code>ï¼šè”åˆä½“çš„å¤§å°å¯å˜ï¼ˆä¸ºæŒ‡å®šçš„å­—æ®µçš„é•¿åº¦ï¼‰ï¼Œè‹¥æœªæŒ‡å®šåˆ™è¯¥è”åˆä½“å¤§å°ä¸ºå…¶æœ€å¤§å­—æ®µçš„å¤§å°ï¼ˆç±»å‹ C è¯­è¨€ï¼‰</li>
<li><code>size[N]</code>ï¼šè¯¥è”åˆä½“è¢«å¡«å……åˆ°æŒ‡å®šçš„å¤§å° <code>N</code></li>
</ul>
<h3 id="èµ„æº"><a href="#èµ„æº" class="headerlink" title="èµ„æº"></a>èµ„æº</h3><p>èµ„æºçš„å®šä¹‰æ˜¯ä½œä¸ºä¸€ä¸ªç³»ç»Ÿè°ƒç”¨çš„è¾“å‡ºä½œä¸ºå¦ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨è¾“å…¥çš„å€¼ã€‚åœ¨å‰é¢çš„æ—¶å€™å…¶å®å·²ç»æ˜¯æåˆ°è¿‡äº†ï¼Œä½¿ç”¨openç³»ç»Ÿè°ƒç”¨æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦å†äº¤ç”±closeç³»ç»Ÿè°ƒç”¨è¿›è¡Œå…³é—­ï¼Œå¦‚æœè¦å®ç°è¿™æ ·çš„æ•ˆæœåˆ™éœ€è¦å£°æ˜ä¸€ä¸ªèµ„æºã€‚èµ„æºçš„å½¢å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;resource&quot;</span> identifier <span class="string">&quot;[&quot;</span> underlying_type <span class="string">&quot;]&quot;</span> [ <span class="string">&quot;:&quot;</span> <span class="keyword">const</span> (<span class="string">&quot;,&quot;</span> <span class="keyword">const</span>)* ]</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­çš„<code>identifier</code>å³ä½å…¶æ ‡è¯†ä¹Ÿå°±æ˜¯åå­—ï¼Œåé¢çš„<code>underlying_type</code> å¯ä»¥æ˜¯ <code>int8</code>, <code>int16</code>, <code>int32</code>, <code>int64</code>, <code>intptr</code> æˆ–è€…æ˜¯å¦ä¸€ä¸ªèµ„æºã€‚å¸¸é‡é›†åˆå¯ä»¥ä½œä¸ºå¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºè¯¥èµ„æºçš„ç‰¹æ®Šå€¼ï¼ˆæ¯”å¦‚è¯´ 0xdeadbeefï¼‰ï¼Œç‰¹æ®Šå€¼å¶å°”è¢«ç”¨ä½œèµ„æºçš„å€¼ï¼Œè‹¥æœªæŒ‡å®šç‰¹æ®Šå€¼ï¼Œåˆ™ä¼šä½¿ç”¨ç‰¹æ®Šå€¼ <code>0</code>ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">resource fd[int32]: <span class="number">0xffffffffffffffff</span>, AT_FDCWD, <span class="number">1000000</span></span><br><span class="line">resource sock[fd]</span><br><span class="line">resource sock_unix[sock]</span><br><span class="line"></span><br><span class="line">socket(...) <span class="function">sock</span></span><br><span class="line"><span class="function"><span class="title">accept</span><span class="params">(fd sock, ...)</span> sock</span></span><br><span class="line"><span class="function"><span class="title">listen</span><span class="params">(fd sock, backlog int32)</span></span></span><br></pre></td></tr></table></figure>

<p>èµ„æºä¸ä¸€å®šæ˜¯ç³»ç»Ÿè°ƒç”¨çš„è¿”å›ï¼Œä»–å¯ä»¥åƒå…¶ä»–ä»»ä½•æ•°æ®ä¸€æ ·è¢«ä½¿ç”¨ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">resource my_resource[int32]</span><br><span class="line"></span><br><span class="line">request_producer(..., arg ptr[out, my_resource])</span><br><span class="line">request_consumer(..., arg ptr[inout, test_struct])</span><br><span class="line"></span><br><span class="line">test_struct &#123;</span><br><span class="line">	...</span><br><span class="line">	attr	my_resource</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯¹äºæ›´ä¸ºå¤æ‚çš„ç”Ÿäº§è€…&#x2F;æ¶ˆè´¹è€…åœºæ™¯ï¼Œå­—æ®µå±æ€§ä¹Ÿå¯ä»¥è¢«åˆ©ç”¨ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">resource my_resource_1[int32]</span><br><span class="line">resource my_resource_2[int32]</span><br><span class="line"></span><br><span class="line">request_produce1_consume2(..., arg ptr[inout, test_struct])</span><br><span class="line"></span><br><span class="line">test_struct &#123;</span><br><span class="line">	...</span><br><span class="line">	<span class="function">field0	<span class="title">my_resource_1</span>	<span class="params">(out)</span></span></span><br><span class="line"><span class="function">	field1	<span class="title">my_resource_2</span>	<span class="params">(in)</span></span></span><br><span class="line"><span class="function">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="ç±»å‹åˆ«å"><a href="#ç±»å‹åˆ«å" class="headerlink" title="ç±»å‹åˆ«å"></a>ç±»å‹åˆ«å</h3><p>è¿™ä¸ªçš„å½¢å¼å¾ˆç±»ä¼¼äºCè¯­è¨€ä¸­çš„<code>typedef</code>ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">type identifier underlying_type</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">type bool8		int8[<span class="number">0</span>:<span class="number">1</span>]</span><br><span class="line">type bool16		int16[<span class="number">0</span>:<span class="number">1</span>]</span><br><span class="line">type bool32		int32[<span class="number">0</span>:<span class="number">1</span>]</span><br><span class="line">type bool64		int64[<span class="number">0</span>:<span class="number">1</span>]</span><br><span class="line">type boolptr	intptr[<span class="number">0</span>:<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">type fileoff[BASE] BASE</span><br><span class="line"></span><br><span class="line">type filename <span class="built_in">string</span>[filename]</span><br><span class="line"></span><br><span class="line">type buffer[DIR] ptr[DIR, <span class="built_in">array</span>[int8]]</span><br></pre></td></tr></table></figure>

<p>åœ¨å¸ƒå°”ä¸­çš„å–å€¼è¿”å›å°±æ˜¯0å’Œ1æ‰€ä»¥å¯ä»¥ä½¿ç”¨<code>intN[0:1]</code>æ¥è¾¾åˆ°æ•ˆæœï¼Œä¸è¿‡åœ¨åé¢æ¯æ¬¡ä½¿ç”¨ä¼šä½¿çš„æ˜“è¯»æ€§å¤§æ‰“æŠ˜æ‰£ï¼Œæ‰€ä»¥å¯ä»¥å®šä¹‰ä¸ºboolã€‚</p>
<h3 id="ç±»å‹æ¨¡æ¿"><a href="#ç±»å‹æ¨¡æ¿" class="headerlink" title="ç±»å‹æ¨¡æ¿"></a>ç±»å‹æ¨¡æ¿</h3><p>å…¶å½¢å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">type optional[T] [</span><br><span class="line">	val		T</span><br><span class="line">	<span class="keyword">void</span>	<span class="keyword">void</span></span><br><span class="line">] [varlen]</span><br></pre></td></tr></table></figure>

<p>å…¶åœ¨çš„ç®€å•çš„ç”¨æ³•ä¸º</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">type buffer[DIR] ptr[DIR, <span class="built_in">array</span>[int8]]</span><br><span class="line">type fileoff[BASE] BASE</span><br><span class="line">type nlattr[TYPE, PAYLOAD] &#123;</span><br><span class="line">	nla_len		len[parent, int16]</span><br><span class="line">	nla_type	<span class="keyword">const</span>[TYPE, int16]</span><br><span class="line">	payload		PAYLOAD</span><br><span class="line">&#125; [align_4]</span><br><span class="line"></span><br><span class="line">syscall(a buffer[in], b fileoff[int64], c ptr[in, nlattr[FOO, int32]])</span><br></pre></td></tr></table></figure>

<h3 id="é•¿åº¦"><a href="#é•¿åº¦" class="headerlink" title="é•¿åº¦"></a>é•¿åº¦</h3><p>ä½ å¯ä»¥ä½¿ç”¨å…³é”®å­— <code>len</code>ã€<code>bytesize</code>ã€<code>bitsize</code> æ¥æŒ‡å®šç»“æ„ä½“å½“ä¸­ç‰¹å®šå­—æ®µçš„é•¿åº¦ï¼Œè‹¥æ˜¯ <code>len</code> çš„å‚æ•°ä¸ºä¸€ä¸ªæŒ‡é’ˆï¼Œåˆ™å…¶å–å€¼ä¸ºæŒ‡é’ˆæ‰€æŒ‡å¯¹è±¡çš„å¤§å°ï¼Œè‹¥è¦è¡¨ç¤ºä¸€ä¸ª N å­—èŠ‚çš„å­—ä¸­å­—æ®µçš„é•¿åº¦ï¼Œåˆ™åº”å½“ä½¿ç”¨ <code>bytesizeN</code>ï¼Œå…¶ä¸­ N çš„å–å€¼å¯ä»¥ä¸º 1ã€2ã€4ã€8ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">write(fd fd, buf ptr[in, <span class="built_in">array</span>[int8]], count len[buf])</span><br><span class="line"></span><br><span class="line">sock_fprog &#123;</span><br><span class="line">	len	len[filter, int16]</span><br><span class="line">	filter	ptr[in, <span class="built_in">array</span>[sock_filter]]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨ä¸Šé¢çš„<code>write</code>ç³»ç»Ÿè°ƒç”¨ä¸­ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°çš„ç±»å‹ä¸º<code>len[buf]</code>ï¼Œè¿™é‡Œçš„å«ä¹‰è¡¨ç¤ºbufçš„é•¿åº¦ã€‚åœ¨ sock_fprog è¿™ä¸ªç»“æ„ä½“å½“ä¸­ï¼Œæˆ‘ä»¬ç»™å…¶å­—æ®µ len è®¾ç½®çš„å€¼ä¸ºå…¶ filter å­—æ®µçš„é•¿åº¦ï¼Œç±»å‹ä¸º int 16ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">s1 &#123;</span><br><span class="line">    f0      len[s2]  <span class="meta"># length of s2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">s2 &#123;</span><br><span class="line">    f0      s1</span><br><span class="line">    f1      <span class="built_in">array</span>[int32]</span><br><span class="line">    f2      len[parent, int32]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è‹¥è¦è¡¨ç¤ºçˆ¶ç±»çš„é•¿åº¦ï¼Œå¯ä»¥ä½¿ç”¨ <code>len[parent, intN]</code>ï¼Œè‹¥è¦åœ¨ç»“æ„ä½“äº’ç›¸åµŒå…¥æ—¶è¡¨ç¤ºæ›´é¡¶å±‚çš„çˆ¶ç±»çš„é•¿åº¦ï¼Œå¯ä»¥æŒ‡å®šç‰¹å®šçˆ¶ç±»çš„ç±»å‹åç§°ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">s1 &#123;</span><br><span class="line">	a	ptr[in, s2]</span><br><span class="line">	b	ptr[in, s3]</span><br><span class="line">	c	<span class="built_in">array</span>[int8]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">s2 &#123;</span><br><span class="line">	d	<span class="built_in">array</span>[int8]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">s3 &#123;</span><br><span class="line"># This refers to the <span class="built_in">array</span> c in the parent s1.</span><br><span class="line">	e	len[s1:c, int32]</span><br><span class="line"># This refers to the <span class="built_in">array</span> d in the sibling s2.</span><br><span class="line">	f	len[s1:a:d, int32]</span><br><span class="line"># This refers to the <span class="built_in">array</span> k in the child s4.</span><br><span class="line">	g	len[i:j, int32]</span><br><span class="line"># This refers to syscall argument l.</span><br><span class="line">	h	len[syscall:l, int32]</span><br><span class="line">	i	ptr[in, s4]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">s4 &#123;</span><br><span class="line">	j	<span class="built_in">array</span>[int8]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo(k ptr[in, s1], l ptr[in, <span class="built_in">array</span>[int8]])</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå¯ä»¥çœ‹å‡ºlenä¹Ÿé€‚ç”¨äºæ›´ä¸ºå¤æ‚çš„è·¯å¾„å¯»å€ã€‚</p>
<h3 id="è¿›ç¨‹"><a href="#è¿›ç¨‹" class="headerlink" title="è¿›ç¨‹"></a>è¿›ç¨‹</h3><p><code>proc</code> ç±»å‹ç”¨äºè¡¨ç¤ºæ¯ä¸ªè¿›ç¨‹çš„æ•°å€¼ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºæ¯ä¸ªæ‰§è¡Œè€…æä¾›ä¸€ä¸ªå•ç‹¬çš„æ•°å€¼èŒƒå›´ï¼Œè¿™æ ·ä»–ä»¬å°±ä¸ä¼šç›¸äº’å¹²æ‰°ã€‚</p>
<p>æœ€ç®€å•çš„ä¾‹å­æ˜¯ä¸€ä¸ªç«¯å£å·ã€‚<code>proc [20000, 4, int16be]</code> ç±»å‹æ„å‘³ç€æˆ‘ä»¬è¦ä» 20000 å¼€å§‹ç”Ÿæˆä¸€ä¸ª<code> int16be</code> æ•´æ•°ï¼Œå¹¶ä¸ºæ¯ä¸ªè¿›ç¨‹åˆ†é… 4 ä¸ªå€¼ã€‚å› æ­¤ï¼Œæ‰§è¡Œè€…ç¼–å· n å°†å¾—åˆ° <code>[20000 + n * 4, 20000 + (n + 1) * 4]</code> èŒƒå›´å†…çš„å€¼ã€‚</p>
<h3 id="æ•´å‹å¸¸é‡"><a href="#æ•´å‹å¸¸é‡" class="headerlink" title="æ•´å‹å¸¸é‡"></a>æ•´å‹å¸¸é‡</h3><p>æ•´å‹å¸¸é‡å¯ä»¥æŒ‡å®šä¸ºåè¿›åˆ¶ã€<code>0x</code> å¼€å¤´çš„åå…­è¿›åˆ¶ã€ç”¨å•å¼•å· <code>&#39;</code> åŒ…è£¹çš„å­—ç¬¦ï¼Œæˆ–è€…ä»å†…æ ¸å¤´æ–‡ä»¶ä¸­æå–å‡ºæ¥çš„ç”± <code>define</code> å®šä¹‰çš„å¸¸é‡ï¼ˆæ¯”å¦‚è¯´ <code>O_RDONLY</code>ï¼‰ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">foo(a <span class="keyword">const</span>[<span class="number">10</span>], b <span class="keyword">const</span>[<span class="number">-10</span>])</span><br><span class="line">foo(a <span class="keyword">const</span>[<span class="number">0xabcd</span>])</span><br><span class="line">foo(a int8[<span class="string">&#x27;a&#x27;</span>:<span class="string">&#x27;z&#x27;</span>])</span><br><span class="line">foo(a <span class="keyword">const</span>[PATH_MAX])</span><br><span class="line">foo(a ptr[in, <span class="built_in">array</span>[int8, MY_PATH_MAX]])</span><br><span class="line">define MY_PATH_MAX	PATH_MAX + <span class="number">2</span></span><br></pre></td></tr></table></figure>

<h3 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h3><p>æè¿°æ–‡ä»¶è¿˜åŒ…æ‹¬ç”¨ä»¥è¿›è¡Œå†…æ ¸å¤´æ–‡ä»¶åŒ…å«çš„ <code>include</code> æŒ‡ä»¤ï¼Œç”¨ä»¥åŒ…å«å†…æ ¸å¤´æ–‡ä»¶ç›®å½•çš„ <code>incdir</code> æŒ‡ä»¤ï¼Œä»¥åŠç”¨ä»¥è®¾ç½®å¸¸é‡çš„ <code>define</code> æŒ‡ä»¤ã€‚</p>
<p>syzkaller executor è¿˜å®šä¹‰äº†ä¸€äº›ä¼ªç³»ç»Ÿè°ƒç”¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æè¿°æ–‡ä»¶ä¸­ä½¿ç”¨è¿™äº›ä¼ªç³»ç»Ÿè°ƒç”¨ã€‚è¿™äº›ä¼ªç³»ç»Ÿè°ƒç”¨è¢«æ‰©å±•ä¸º C ä»£ç ï¼Œå¯ä»¥æ‰§è¡Œç”¨æˆ·è‡ªå®šä¹‰çš„ä¸€äº›æ“ä½œã€‚</p>
<h2 id="å°è¯•æ•æ‰ç®€å•æº¢å‡ºæ´"><a href="#å°è¯•æ•æ‰ç®€å•æº¢å‡ºæ´" class="headerlink" title="å°è¯•æ•æ‰ç®€å•æº¢å‡ºæ´"></a>å°è¯•æ•æ‰ç®€å•æº¢å‡ºæ´</h2><h3 id="syz-extract"><a href="#syz-extract" class="headerlink" title="syz-extract"></a>syz-extract</h3><p>ç¬¬ä¸€æ­¥æ˜¯ä»å†…æ ¸æºæ–‡ä»¶ä¸­æå–ç¬¦å·å¸¸é‡çš„å€¼ï¼š<code>syz-extract</code> ä¼šæ ¹æ® syzlang æ–‡ä»¶ä»å†…æ ¸æºæ–‡ä»¶ä¸­æå–å‡ºä½¿ç”¨çš„å¯¹åº”çš„å®ã€ç³»ç»Ÿè°ƒç”¨å·ç­‰çš„å€¼ï¼Œç”Ÿæˆ <code>.const</code> æ–‡ä»¶</p>
<h3 id="syz-sysgen"><a href="#syz-sysgen" class="headerlink" title="syz-sysgen"></a>syz-sysgen</h3><p>ç¬¬äºŒæ­¥ä¾¿æ˜¯å°†æè¿°ç¿»è¯‘æˆ Golang ä»£ç ï¼š<code>syz-sysgen</code> é€šè¿‡ syzlang æ–‡ä»¶ä¸ .const æ–‡ä»¶è¿›è¡Œè¯­æ³•åˆ†æä¸è¯­ä¹‰åˆ†æï¼Œç”ŸæˆæŠ½è±¡è¯­æ³•æ ‘ï¼Œæœ€ç»ˆç”Ÿæˆä¾› syzkaller ä½¿ç”¨çš„ golang ä»£ç ï¼Œåˆ†ä¸ºå¦‚ä¸‹å››ä¸ªæ­¥éª¤ï¼š</p>
<ul>
<li><strong>assignSyscallNumbers</strong>ï¼šåˆ†é…ç³»ç»Ÿè°ƒç”¨å·ï¼Œæ£€æµ‹ä¸æ”¯æŒçš„ç³»ç»Ÿè°ƒç”¨å¹¶ä¸¢å¼ƒ</li>
<li><strong>patchConsts</strong>ï¼šå°† AST ä¸­çš„å¸¸é‡æ›¿æ¢ä¸ºå¯¹åº”çš„å€¼</li>
<li><strong>check</strong>ï¼šè¿›è¡Œè¯­ä¹‰åˆ†æ</li>
<li><strong>genSyscalls</strong>ï¼šä» AST ç”Ÿæˆ prog å¯¹è±¡</li>
</ul>
<h3 id="å®æˆ˜æµç¨‹"><a href="#å®æˆ˜æµç¨‹" class="headerlink" title="å®æˆ˜æµç¨‹"></a>å®æˆ˜æµç¨‹</h3><p>é¦–å…ˆç¼–å†™ä¸€ä¸ªå…·æœ‰æ¼æ´çš„é©±åŠ¨</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;linux/module.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;linux/kernel.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;linux/init.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;linux/fs.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;linux/device.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;linux/slab.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DEVICE_NAME <span class="meta-string">&quot;intel_rapl_msrdv&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CLASS_NAME <span class="meta-string">&quot;intel_rapl_msrmd&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DEVICE_PATH <span class="meta-string">&quot;/dev/intel_rapl_msrdv&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> major_num;</span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">struct</span> <span class="keyword">class</span> *<span class="title">module_class</span> =</span> <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">device</span> *<span class="title">module_device</span> =</span> <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">file</span> *__<span class="title">file</span> =</span> <span class="literal">NULL</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">inode</span> *__<span class="title">inode</span> =</span> <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> __init <span class="title">test_init</span><span class="params">(<span class="keyword">void</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> __exit <span class="title">test_exit</span><span class="params">(<span class="keyword">void</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">test_open</span><span class="params">(struct inode *, struct file *)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">ssize_t</span> <span class="title">test_read</span><span class="params">(struct file *, <span class="keyword">char</span> __user *, <span class="keyword">size_t</span>, <span class="keyword">loff_t</span> *)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">ssize_t</span> <span class="title">test_write</span><span class="params">(struct file *, <span class="keyword">const</span> <span class="keyword">char</span> __user *, <span class="keyword">size_t</span>, <span class="keyword">loff_t</span> *)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">test_release</span><span class="params">(struct inode *, struct file *)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">long</span> <span class="title">test_ioctl</span><span class="params">(struct file *, <span class="keyword">unsigned</span> <span class="keyword">int</span>, <span class="keyword">unsigned</span> <span class="keyword">long</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">file_operations</span> <span class="title">test_op</span> =</span></span><br><span class="line">    &#123;</span><br><span class="line">        .owner = THIS_MODULE,</span><br><span class="line">        .unlocked_ioctl = test_ioctl,</span><br><span class="line">        .open = test_open,</span><br><span class="line">        .read = test_read,</span><br><span class="line">        .write = test_write,</span><br><span class="line">        .release = test_release,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">test_open</span><span class="params">(struct inode *__inode, struct file *__file)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">ssize_t</span> <span class="title">test_read</span><span class="params">(struct file *__file, <span class="keyword">char</span> __user *user_buf, <span class="keyword">size_t</span> size, <span class="keyword">loff_t</span> *__loff)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">ssize_t</span> <span class="title">test_write</span><span class="params">(struct file *__file, <span class="keyword">const</span> <span class="keyword">char</span> __user *user_buf, <span class="keyword">size_t</span> size, <span class="keyword">loff_t</span> *__loff)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> *param;</span><br><span class="line"></span><br><span class="line">    param = kmalloc(<span class="number">512</span>, GFP_KERNEL);</span><br><span class="line">    copy_from_user(param, user_buf, <span class="number">4096</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">test_release</span><span class="params">(struct inode *__inode, struct file *__file)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">long</span> <span class="title">test_ioctl</span><span class="params">(struct file *__file, <span class="keyword">unsigned</span> <span class="keyword">int</span> cmd, <span class="keyword">unsigned</span> <span class="keyword">long</span> param)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> __init <span class="title">test_init</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    major_num = register_chrdev(<span class="number">0</span>, DEVICE_NAME, &amp;test_op);</span><br><span class="line">    <span class="keyword">if</span> (major_num &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> major_num;</span><br><span class="line"></span><br><span class="line">    module_class = class_create(THIS_MODULE, CLASS_NAME);</span><br><span class="line">    <span class="keyword">if</span> (IS_ERR(module_class))</span><br><span class="line">    &#123;</span><br><span class="line">        unregister_chrdev(major_num, DEVICE_NAME);</span><br><span class="line">        <span class="keyword">return</span> PTR_ERR(module_class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    module_device = device_create(module_class, <span class="literal">NULL</span>, MKDEV(major_num, <span class="number">0</span>), <span class="literal">NULL</span>, DEVICE_NAME);</span><br><span class="line">    <span class="keyword">if</span> (IS_ERR(module_device))</span><br><span class="line">    &#123;</span><br><span class="line">        class_destroy(module_class);</span><br><span class="line">        unregister_chrdev(major_num, DEVICE_NAME);</span><br><span class="line">        <span class="keyword">return</span> PTR_ERR(module_device);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    __file = filp_open(DEVICE_PATH, O_RDONLY, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (IS_ERR(__file))</span><br><span class="line">    &#123;</span><br><span class="line">        device_destroy(module_class, MKDEV(major_num, <span class="number">0</span>));</span><br><span class="line">        class_destroy(module_class);</span><br><span class="line">        unregister_chrdev(major_num, DEVICE_NAME);</span><br><span class="line">        <span class="keyword">return</span> PTR_ERR(__file);</span><br><span class="line">    &#125;</span><br><span class="line">    __inode = file_inode(__file);</span><br><span class="line">    __inode-&gt;i_mode |= <span class="number">0666</span>;</span><br><span class="line">    filp_close(__file, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> __exit <span class="title">test_exit</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    device_destroy(module_class, MKDEV(major_num, <span class="number">0</span>));</span><br><span class="line">    class_destroy(module_class);</span><br><span class="line">    unregister_chrdev(major_num, DEVICE_NAME);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module_init(test_init);</span><br><span class="line">module_exit(test_exit);</span><br><span class="line">MODULE_LICENSE(<span class="string">&quot;GPL&quot;</span>);</span><br><span class="line">MODULE_AUTHOR(<span class="string">&quot;196082&quot;</span>);</span><br><span class="line">MODULE_INFO(intree, <span class="string">&quot;Y&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°è¿™é‡Œå­˜åœ¨æ˜æ˜¾çš„å †æº¢å‡ºã€‚</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">obj-m += vuln_device.o</span><br><span class="line">CURRENT_PATH := <span class="variable">$(<span class="built_in">shell</span> pwd)</span></span><br><span class="line">LINUX_KERNEL := <span class="variable">$(<span class="built_in">shell</span> uname -r)</span></span><br><span class="line">LINUX_KERNEL_PATH := ~/linux-5.11</span><br><span class="line"><span class="section">all:</span></span><br><span class="line">	make -C <span class="variable">$(LINUX_KERNEL_PATH)</span> M=<span class="variable">$(CURRENT_PATH)</span> modules</span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">	make -C <span class="variable">$(LINUX_KERNEL_PATH)</span> M=<span class="variable">$(CURRENT_PATH)</span> clean</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ä¸Šè¿°çš„<code>Makefile</code>ç¼–è¯‘</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">include &lt;linux/fs.h&gt;</span><br><span class="line"></span><br><span class="line">resource fd_111[fd]</span><br><span class="line"></span><br><span class="line">open$test(file ptr[in, <span class="built_in">string</span>[<span class="string">&quot;/dev/intel_rapl_msrdv&quot;</span>]], flags flags[vuln_open_flags], mode flags[vuln_open_mode]) fd_111</span><br><span class="line">read$test(fd fd_111, buf buffer[out], count len[buf])</span><br><span class="line">write$test(fd fd_111, buf buffer[in], count len[buf])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">vuln_open_flags = O_RDONLY, O_WRONLY, O_RDWR, O_APPEND, FASYNC, O_CLOEXEC, O_CREAT, O_DIRECT, O_DIRECTORY, O_EXCL, O_LARGEFILE, O_NOATIME, O_NOCTTY, O_NOFOLLOW, O_NONBLOCK, O_PATH, O_SYNC, O_TRUNC, __O_TMPFILE</span><br><span class="line">vuln_open_mode = S_IRUSR, S_IWUSR, S_IXUSR, S_IRGRP, S_IWGRP, S_IXGRP, S_IROTH, S_IWOTH, S_IXOTH</span><br></pre></td></tr></table></figure>

<p>ç¼–å†™<code>syzlang</code>éšåæ”¾å…¥åˆ°<code>sys/linux/</code>ç›®å½•ä¸‹ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">make bin/syz-extract</span><br><span class="line">make bin/syz-sysgen</span><br></pre></td></tr></table></figure>

<p>ç¼–è¯‘ syz-extract å’Œ syz-sysgen</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/syz-extract -os linux -sourcedir <span class="string">&quot;~/linux-5.11&quot;</span> -arch amd64 vuln_test.txt</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡<code>syz_extract</code>ç”Ÿæˆå¯¹åº”çš„<code>const</code>æ–‡ä»¶ï¼Œéšåé‡æ–°è¿è¡Œ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./bin/syz-sysgen</span><br><span class="line">make generate</span><br><span class="line">make</span><br></pre></td></tr></table></figure>

<p>éšåé…ç½®configæ–‡ä»¶</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;target&quot;</span>: <span class="string">&quot;linux/amd64&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;http&quot;</span>: <span class="string">&quot;127.0.0.1:56741&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;rpc&quot;</span>: <span class="string">&quot;127.0.0.1:0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;sshkey&quot;</span>: <span class="string">&quot;/media/psf/pwn/fuzz01/bullseye.id_rsa&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;workdir&quot;</span>: <span class="string">&quot;/media/psf/pwn/fuzz01&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;kernel_obj&quot;</span>: <span class="string">&quot;/home/parallels/linux-5.11&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;syzkaller&quot;</span>: <span class="string">&quot;/home/parallels/fuzz/gopath/syzkaller&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;sandbox&quot;</span>: <span class="string">&quot;setuid&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;isolated&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;enable_syscalls&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;open$test&quot;</span>,</span><br><span class="line">        <span class="string">&quot;read$test&quot;</span>,</span><br><span class="line">        <span class="string">&quot;write$test&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">&quot;vm&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;targets&quot;</span>: [</span><br><span class="line">            <span class="string">&quot;127.0.0.1:10021&quot;</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="attr">&quot;pstore&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">&quot;target_dir&quot;</span>: <span class="string">&quot;/home/fuzzdir&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;target_reboot&quot;</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå†™æ³•ä¸ä¸Šé¢ç•¥æœ‰ä¸åŒï¼Œä¸è¿‡çœ‹ä¸€ä¸‹æ˜¯æŒºå¥½ç†è§£çš„ã€‚å…¶ä¸­çš„<code>enable_syscalls</code>ä¸»è¦æ˜¯é™åˆ¶åªå…è®¸è°ƒç”¨ä»€ä¹ˆç³»ç»Ÿè°ƒç”¨ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ./bin/syz-manager -config=/media/psf/pwn/fuzz01/config.json</span><br></pre></td></tr></table></figure>

<p>æœ€åé€šè¿‡ä¸Šè¿°å‘½ä»¤å¯åŠ¨fuzzã€‚</p>
<table>
<thead>
<tr>
<th>Descriptions</th>
<th>Count</th>
<th>Last Time</th>
<th>Report</th>
</tr>
</thead>
<tbody><tr>
<td>KASAN: slab-out-of-bounds Write in test_write</td>
<td>1</td>
<td>2023&#x2F;11&#x2F;10 16:31</td>
<td>reproducing</td>
</tr>
</tbody></table>
<p>å½“è·‘å‡ºä¸€ä¸ª<code>crash</code>ä¼šå‡ºç°å¦‚ä¸Šè¡¨æ ¼ï¼Œå…¶ä¸€ä¸ªå«ä¹‰å¯ä»¥çœ‹åˆ°æ˜¯åœ¨<code>test_write</code>ä¸­è§¦å‘äº†ä¸€ä¸ª<code>slab-out-of-bounds</code>ï¼Œä¹Ÿå°±æ˜¯è¶Šç•Œã€‚ç„¶åæœ€åçš„<code>report</code>æ˜¾ç¤ºçš„çŠ¶æ€æ˜¯æ­£åœ¨å°è¯•é‡ç°è¿™ä¸ª<code>crash</code>è¿æ°”ä¸ä½³çš„æ˜¯è¿™ä¸ªå¹¶ä¸èƒ½é‡ç°ï¼Œå¦‚æœèƒ½å¤Ÿé‡ç°åˆ™ä¼šæ˜¾ç¤ºå…¶å¯¹åº”çš„ç»“æœï¼Œå¦‚æœä¸€ä¸ªå“ç›¸å¥½çš„æ¼æ´å…¶<code>report</code>ä¼šæ˜¾ç¤º<code>has C repo</code>è¡¨ç¤ºæœ‰è¯¥<code>crash</code>çš„Cè¯­è¨€ä»£ç ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">r2 = open$test(&amp;(<span class="number">0x7f0000000380</span>), <span class="number">0x10000</span>, <span class="number">0x2</span>)</span><br><span class="line">write$test(r2, &amp;(<span class="number">0x7f00000003c0</span>)=<span class="string">&quot;da0f433ee1bffca3085037fc1dcce3ed4bce4ba262cfd2069703973bbd42cb061bc099e240f5a5645d2d34a9cb270151cd6edcdd7e26dbb7ff57eae5352b1920eb5e2354178f009c8c3b86de024a06cd9c24386cf0db616ae8ef502687bc61db26bb28ff8f81500321e73feb9a639fbdf287fa98c6a0e6de0510c675e920cf4e5dc6e2cb9fe4e4be66ddb29bf45283b0f9359a0028e4ffc65c54ec966e16113a6b49e3ba85f9f29aa297e978a5944426f644de7a37cfd242563e97b2ec55f3633fe9569b776c3a299ec199153afd8187b798f515ae9fdf30ebda4d9bfad062514718bef675a6528e2879aeb56ad583077ffe63f4a0e994ef211deb84f15379f6b1fa2067cf9e4d4bd7bfc5ed7ec8133ae06be457e498087f306d661684531a7f353dfeb8982d89a1a6a3554b5bbe27379c20c9bae3a5672ea0176721d8e38fbb656064062ff431efac310c5a3dc36d754b2407a82d63e152ecefa945219d0149fd17ae8c37b563ae571108ea67e7642da91f629d797380411d153b68e2ce1050f75c8be7ee1f4c626127223ee46d61986db8685710a79b8cf636570c5a522a2d83971fb5fa457326030a2899e3acfb54a4764cb8e46892c49e4ca23b633384886260f23e6ca06522928c82364950d8e24feab8c02b2442a1a102eb4374c721b6c59f66ad306ce03215d5f4db91151b0690669a09b5b59f249b64172a0009be02dd91a8c8733f9b9a64c72b3342c1c7e770e52fe6c31fff0d856ac0de9344555449e2c817f27363ef1694d10c2dd92b15f0698b003f586444a1b529c2ec2d338b64ba2bfa2ecd285b4631f8df46969a646a291c7e967c323589e49e5e01b29547848f62e9672a07e9a223ebc612058a4d1849ba105b09bbfbb2ee4dc62d32ee80ed4302a2921ed7de6f51bf068fe420debed43a0a0ecad74bba4b0d576afe8e4df6900d7fe7104427c87c1559576020c751bc040f905caf5c155331af5645872210cc76dc3a356bb3abdd373c9e02f1770f5df9b9de527e6a3359016c56199e35a832b658a410e2a97f549edf96f8781aeb5fa08e922f333d86026c62f1a24f865074202002a85042bb85ddbcbf4430b446bb0cdf984682f1d8fc7a1889352407d1c781a653fe489ece1e7ffbdc15cb0cec3ff776b7d1a34fc9642fcbdc8f2a732dae5f00a692e78dbd4f6a94986f35b38ac8aecbe3c2bc4a7932b5e933c08c4c5f8b90eb1ce3c80af44fd11d2715ec76b369e6468170a93757083a701a2d84c08a1602533ee4ab629f0839a984546a8aa1b7fee547fa4d78f6d67397ea1e9f853e22da69fe40ba837cc6a64a1ad873d971fe383ae2c862301672c236f758aa1ede00483cc4f40b066e1e3e9997ba723141726af050ba7789c9e7451a0baf52e9d49b44e8d92ab5df925598e6d9b8b10bee1089c6ff3f9dd9dfd660f832c025fcb20a159bd305563647ae9c4f0fedf7f3fd9d2d0589956cee8f5ec040f043cd931539fa7880fd69147e5a32c468611774f18987adca95a0eaa0b962f4c2fdcb91ac52ec28e39704b924bd3fc0e1f796bbd9c8b815b646b682f1d4796b9e567112453291220a7f5d2012a565f7abfba7fd318e72530b1cf04d74b42e64627c6936587c81d9bae45fc0cc2815674946427529151641aba2284c17c8ca26d7b8e0cf45ccb12db3705693a9eeb5b92d84830aae5aa170e6317544681b24a8fcb01ff769d3e89f65e9b205540239d43b81a6c2679810a3467ff0bef5bce56bcb853b60744315fc0f2899e6db88edd5ff2c8d11bd0ea553b3b1766f2ba0ac02e46805a89cfb8f71d743666556f530b759528877b8b71aa6f882616c8a795ef295961007c07479673af54818ccc79b5e43e2bbdcf00ff3d9cbfe679c6e7fc688dd0797c0a7a7e22cbdad3f1f3e3e99f8ed3b17b7f04de17e5817d48abb90203163317ee630fae9bbbe06887208ce9138b0ce0bb8ce511229698c71351c8cbdef2dcf0279c4b334c55254babf6bf4b00a7a2e89557550f338ab5e332824fbf4f1f774b970248916bdd4922fe69c825d62950c6b6a98f49795ef6fbacfc65fd8e879bad0e2963f46be54ae3c699339384cbde926d360501a6a0f0f21090d8f735301c04230d969ec4e88f1e18fc62e656ac03610dc1772295df75ca08fbd4e1fd7f39eb2cb349878a4936d35f335d1eac7da574276a6d43672393a747dd7182c27100370667700f3de9b0389cf8ac812f5ad07c7517a2a64ca22b17f120011e2a70d95cb8f7835f7cc0481defaf20665a0418e1385d0306ee26c5a861ef69e37ccb91237c9c106e9b483ae4e1c3957e02f1f5b247c835dff73502bf518d1c80e827c7d6221f1c8ca9226d2a1ef904f5025504544f4024c60ff5bf23f5b79cee9720745bf36a86179d7d0af1758e663bcd6e98d2f9339dc9ecc038a1521bb16edfbb9071fb09c2917a2144c90cd752b5683e321b70271089252da45fbb01ec19e9bc9261f7f50e129d44f6ecfed3222f7bc9943356b46f0aa97f1b03ef95890543c22a00655a8c99fdccd4ef04a7d72084d5c77a96025d5095ed608b19d0f5a7ae778fa4eab4a8f739b5ceb3fc97f11ec67a9b6c6d7ff88a4395e8bc27e8b7034de7be8683c958f2773f2bb985a9bede7e1d39aa7899e1e88aa7d7af00a9a9f084a094636af8160a14626d2c0dc142656911e418aef80dcace137e41ad996984975c62f63e5f0fdc53a699944c2e06d275264375a5330e4a295918e6f0f6e57d82e2de705eb9ce5791eac9a117d9912c6d6ae1ffdb08389dfd1eea539d2e9069520076873608d22975dd38bfd1df04c4f9dcac4bfed02af53802f8582ac59321a8453e69a7cb5a5cee4a6940466a5cecb19c9527c94d0441ad4328297f3e92714ee3153b459f45cad7e2a2197da7bb5f3ea498e0b9e49405e8f4c881eb6a9555b82072d5a3fa06b935d0c127244d747a637d09fceaffc64f983aa7df54d59f265ed28ebe79f41ebd72c2a401b88adf0daf4158bc47faebfec1fcf934b55a9bac5da808566db2216c21c17b26e25dc8566e3a14bbddd83b8d2db809a5098f5404e67958fa801f073ba48e5c0b4a5a1a98df77d8d81dd1054c7e8ece8ac44d4c21435e830c7d28927b1a61670886116d4f819bd406dd61c0bc7e57933b9071cd1de7fe9e5e8bfb66c3e637f3dc27329c936b47c2ce5f7bd8d96e889c9a4cfe6ffcfcc1b2de5b1b6cc417952d07413fbaa586bc997db9dc916a529d6e6ef7d358f41d35f888825f6491bea834adb7d57a6fdfe7b61e6ed369329b009404352f168b1adf1683fa8c860e272dcdc5593e100d83fa4bf2fcb4832bd6da307c3910675e36f5df01e1e90253948f17a6b286f50afff315e562d8feb83c8dd68397319022dfd951be06d494e9bba6dc0ddc8c8b20821522ae68bb02b749925c94f7d80566cdfdef0f6076cf7542ec7c064d0a9e1a7f71d5b67a88a94ad19d4a73e3f16d68709e0e5ca166d37c8baa384434732bba3e7d08fba66f012d22e21077a23001f1f0160f4efee36be51edb83910cd2e7362fdc173d5699b634e75489a16580c733ffce3df11d5f482c7ff82cd8c843c0d513404758016955862d308c1e0e36ad3d98652cf837782423451c4e8638990fb65eff25c380caed61a0a8fbd1cc484ecc70467efc17310cef1fd3c075d339f40067b71b15541571be112f85f89afc6fc842b263e3ce57116176402a76e695fd28eacc2da85ee62aafa6bcb896d554f843ee152e6b84b8a3c6aaeea7443b5290cec768ba0ba2aada7dee7438b76861d2434104fac6a86f7448981ab970d27c5268d3d7eac9ff26b657affacbd0dbdc30ecfd0e305fba89461c1d85aef2feb30f0cb9c94a46578d55957984deed9ec02f796246c366adc7cb32eeae18f2d56a86702c04c1dd172a70899d28808d2050d7cdaf78c6975c5dd56ab3435fc40b8019a6bbd8964bc212abb6ab3e82e12604650433964cb48093e46fe79439022f6b862ed96c6bfa59f834a28ae857df0805b6e7b4ed5db1bee79ed3999485131468ebaa043304ce67f01a6b67ac7e0d744326e0c21a857620b0e999534e36c72855a1f674ec301dc06fc1640ee4af225a3f8a1a6ed344bff7b377e957eb6a606c4fb4d82ba4238d3eedeb4ec74ee2dc7341edab9dedfcb49828b901abac4991f5886f663d8d07e77b2b8b4b12c896f28149ca896eb2d9dcb2f18a5ad6c7918e57d0e730d012f39328a94172a9f41946348ed5eed60b87512aec77114c4582ab7a29f0a19e84e52c11b07f14d53b3310cadac1546e0b042243e6afb376192ecd87be7b574f852f411ff5a8a6f7fdb743b568e89a34ba3547b2959f3760e382b75441bea3713c81e31391b10751f80bdb42216d7644d8ab5aedb5ed437e0e7954a1ef4bd6c3cc2aa45b652c86281345eaa3dbaceb684224222db02c9a638475364135284a21097286ef864706c9df5c350dc5933a5ba1d46795f49316705d7ae7cb59f5e91994a6c57ae525189243cd36b8ab1c351eaaa04ace3bccfb1287c4c60667524562b8f350da09e6ca212194d49e6550b2289170c64e8c9d019b4d4f7d888e62b5458c5b28b2eda131079f5e66d35014d5460e7e785bcc7ffc6141384498c55dad57901729fc056a5595850ceb1d5c6d31a6894b8d8b85f9173f9ebc158d2d43952c48d4f3590a4e4fae41ea0aa9c8ab78557fd4e9ca5611b62ca6f0b5f6c46592537f008cd5083b08bc3fd1218773cb10fa44933fbaeed4afa57afae135c8a1898b06a5c2855e3f8a6bfe8ba9a589bceb5f9a5376f220cfdfc977e7416abd7258b40e9df634d966d7d8e665ab3ab6495bd07dcdf32ac3f62eaaf2e18ba093f46c96b7ac2e6fca971dfec82c72fd7241aac6774655ad19b8bebd1766e1afa44510682369083ae89734a7809539193d48146fe83f2401b3a33a0857f8cd2a305bc59e58bf41360fe0abe63a6f99bd12a8d1988a3c52dc3ac7091c71ffbab698284079799bbd66370b473b542dab968670fb8b4444af52b5070601df1702738cb29aceae70c6b916d11bdfc6814d5f57a6b257f62587f4e35525074fc031db80f98b9b59130d831bd8bbaa45ed2544dcb34badeac02b794c19875e3edb4b4b78156995df60b4f03a03a9eae88bc5bc071d0f948f38f9a92511b5939acc135820d10c708edb737c9ad7c7dd80cb9cba5347a712e946409bd400c7bb5badc9ecf969ca886260e184ebcb5826b6de23bd0e0a3935321299d45d0e151c782cde6239490566f11b91bac99fd0d202f20abd4c8fad629c4596b857730ac92cc6e67e3177692dd27f1eaa48ca6d19649d0692bd6ab77772c04535c91660f961222ae3a2fbb2663f4fb737f153595ce9a8b865c2dd36eb19b459e933322ddef02a2412e8dbd3b48e951eb9497f3837a6a3b567c43edb3c4f74bf5356187c591f4419dbc21cec3eb31ed865a6146cb455b6a381f0663f8a09c16eda030839fce28a85faa27a0adbb504cc20e3a1af0c6b29f8a7a8b9cbf2e16cfc4ae9413338a6fe08e30f9c495869828203e774cff77da575ec0399368c5568a5d98e51047ece46b2612fe5ab2613761b58d6dcbd079c7d253db81a540f2b921bd0599b70c3119803fc5e97954feaf4a7f813d77a03a811d2582f14989fca781dc28aa96958b9546cc83fa543bc00928a602f3f4be13ec7f1acb78d57e6ebd599e2a077656ffaf04d9a971a017f2391301fdcd7053925d41f9d355dc229ac94fcc0f0b01070b3cb485cbae3356a5421ff428067e9be643933615b0d3bcbe3a2a6d25&quot;</span>, <span class="number">0x1000</span>)</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢æ˜¯æˆªå–çš„logæ–‡ä»¶ï¼Œå…¶ä¸­ä¼šè®°å½•ç³»ç»Ÿè°ƒç”¨ï¼Œè°ƒç”¨çš„å‚æ•°ç­‰ä¸€ç³»åˆ—ä¿¡æ¯ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">==================================================================</span><br><span class="line">BUG: KASAN: slab-out-of-bounds <span class="keyword">in</span> instrument_copy_from_user include/linux/instrumented.h:135 [inline]</span><br><span class="line">BUG: KASAN: slab-out-of-bounds <span class="keyword">in</span> _copy_from_user+0x66/0xd0 lib/usercopy.c:15</span><br><span class="line">Write of size 4096 at addr ffff88810686f800 by task syz-executor/3452</span><br><span class="line">CPU: 0 PID: 3452 Comm: syz-executor Not tainted 5.11.0 <span class="comment">#1</span></span><br><span class="line">Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.13.0-1ubuntu1.1 04/01/2014</span><br><span class="line">Call Trace:</span><br><span class="line"> __dump_stack lib/dump_stack.c:79 [inline]</span><br><span class="line"> dump_stack+0x9c/0xcf lib/dump_stack.c:120</span><br><span class="line"> print_address_description.constprop.0+0x1a/0x140 mm/kasan/report.c:230</span><br><span class="line"> __kasan_report mm/kasan/report.c:396 [inline]</span><br><span class="line"> kasan_report.cold+0x7f/0x10e mm/kasan/report.c:413</span><br><span class="line"> check_memory_region_inline mm/kasan/generic.c:179 [inline]</span><br><span class="line"> check_memory_region+0x17c/0x1e0 mm/kasan/generic.c:185</span><br><span class="line"> instrument_copy_from_user include/linux/instrumented.h:135 [inline]</span><br><span class="line"> _copy_from_user+0x66/0xd0 lib/usercopy.c:15</span><br><span class="line"> test_write+0x4f/0x70 [vuln_device]</span><br><span class="line"> vfs_write+0x1bf/0x760 fs/read_write.c:603</span><br><span class="line"> ksys_write+0x100/0x210 fs/read_write.c:658</span><br><span class="line"> do_syscall_64+0x33/0x40 arch/x86/entry/common.c:46</span><br><span class="line"> entry_SYSCALL_64_after_hwframe+0x44/0xa9</span><br><span class="line">RIP: 0033:0x7f1a044ec96d</span><br><span class="line">Code: c3 e8 17 32 00 00 0f 1f 80 00 00 00 00 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 &lt;48&gt; 3d 01 f0 ff ff 73 01 c3 48 c7 c1 b8 ff ff ff f7 d8 64 89 01 48</span><br><span class="line">RSP: 002b:00007f1a0325bbf8 EFLAGS: 00000246 ORIG_RAX: 0000000000000001</span><br><span class="line">RAX: ffffffffffffffda RBX: 00007f1a04628f80 RCX: 00007f1a044ec96d</span><br><span class="line">RDX: 000000000000003f RSI: 0000000020001580 RDI: 0000000000000004</span><br><span class="line">RBP: 00007f1a0454a4af R08: 0000000000000000 R09: 0000000000000000</span><br><span class="line">R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000000</span><br><span class="line">R13: 00007fff371812bf R14: 00007fff37181460 R15: 00007f1a0325bd80</span><br><span class="line">Allocated by task 3452:</span><br><span class="line"> kasan_save_stack+0x1b/0x40 mm/kasan/common.c:38</span><br><span class="line"> kasan_set_track mm/kasan/common.c:46 [inline]</span><br><span class="line"> set_alloc_info mm/kasan/common.c:401 [inline]</span><br><span class="line"> ____kasan_kmalloc.constprop.0+0x84/0xa0 mm/kasan/common.c:429</span><br><span class="line"> test_write+0x3f/0x70 [vuln_device]</span><br><span class="line"> vfs_write+0x1bf/0x760 fs/read_write.c:603</span><br><span class="line"> ksys_write+0x100/0x210 fs/read_write.c:658</span><br><span class="line"> do_syscall_64+0x33/0x40 arch/x86/entry/common.c:46</span><br><span class="line"> entry_SYSCALL_64_after_hwframe+0x44/0xa9</span><br><span class="line">The buggy address belongs to the object at ffff88810686f800</span><br><span class="line">The buggy address is located 0 bytes inside of</span><br><span class="line">The buggy address belongs to the page:</span><br><span class="line">page:00000000a4947c90 refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x10686e</span><br><span class="line">head:00000000a4947c90 order:1 compound_mapcount:0</span><br><span class="line">flags: 0x200000000010200(slab|head)</span><br><span class="line">raw: 0200000000010200 ffffea0004335180 0000000300000003 ffff888100041280</span><br><span class="line">raw: 0000000000000000 0000000080080008 00000001ffffffff 0000000000000000</span><br><span class="line">page dumped because: kasan: bad access detected</span><br><span class="line">Memory state around the buggy address:</span><br><span class="line"> ffff88810686f900: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line"> ffff88810686f980: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">&gt;ffff88810686fa00: <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span></span><br><span class="line">                   ^</span><br><span class="line"> ffff88810686fa80: <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span></span><br><span class="line"> ffff88810686fb00: <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span> <span class="built_in">fc</span></span><br><span class="line">==================================================================</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå°±æ˜¯<code>report</code>ç»™å‡ºçš„æ˜¯<code>kernel</code>ç›¸å…³çš„ä¿¡æ¯ï¼Œæ¯”å¦‚å‡½æ•°è°ƒç”¨æ ˆï¼Œä»¥åŠå¯„å­˜å™¨ä¿¡æ¯ç­‰ã€‚</p>
<p>è‡³äºè¿™é‡Œä¸ºä»€ä¹ˆæ— æ³•é‡ç°å‡ºæˆ‘è§‰å¾—ä¸€å¤§åŸå› å°±æ˜¯æˆ‘æ²¡å¯¹è¿™ä¸ªé©±åŠ¨è½½å…¥è®¾ç½®è‡ªå¯åŠ¨ï¼Œå¯¼è‡´ä¸€æ¬¡<code>kernel panic</code>ä¹‹åæ²¡æœ‰é‡æ–°åŠ è½½é©±åŠ¨ï¼ˆ<del>ä¸‹ç­äº†ä¸æäº†ï¼</del>ï¼‰ã€‚å…¶å®æœ‰kernel pwnåŸºç¡€çš„æœ‹å‹è¯»æ‡‚å‰é¢çš„logå’Œ<code>kernel panic</code>çš„ä¿¡æ¯éƒ½ä¼šç‰¹åˆ«è½»æ¾çš„ï¼Œè¿™é‡Œä¸è¯¦ç»†è¯´äº†ï¼</p>

                    
                </div>

                

                <div class="post-bottom-tags-and-share border-box">
                    <div>
                        
                            <ul class="post-tags-box border-box">
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/fuzzing/">fuzzing</a>
                                    </li>
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/LKM/">LKM</a>
                                    </li>
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/syzkaller/">syzkaller</a>
                                    </li>
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/syzlang/">syzlang</a>
                                    </li>
                                
                            </ul>
                        
                    </div>
                    <div>
                        
                    </div>
                </div>

                

                
                    <div class="post-nav border-box">
                        
                            <div class="prev-post">
                                <a class="prev"
                                   rel="prev"
                                   href="/2023/11/17/syzkaller%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%901/"
                                   title="syzkaller: syz-manageræºç åˆ†æ"
                                >
                                    <span class="left arrow-icon flex-center">
                                        <i class="fas fa-chevron-left"></i>
                                    </span>
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">syzkaller: syz-manageræºç åˆ†æ</span>
                                        <span class="post-nav-item">ä¸Šä¸€ç¯‡</span>
                                    </span>
                                </a>
                            </div>
                        
                        
                            <div class="next-post">
                                <a class="next"
                                   rel="next"
                                   href="/2023/10/27/CVE-2022-2588/"
                                   title="CVE-2022-2588å¤ç°"
                                >
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">CVE-2022-2588å¤ç°</span>
                                        <span class="post-nav-item">ä¸‹ä¸€ç¯‡</span>
                                    </span>
                                    <span class="right arrow-icon flex-center">
                                        <i class="fas fa-chevron-right"></i>
                                    </span>
                                </a>
                            </div>
                        
                    </div>
                

                
                    


    <div class="comments-container border-box">
        <div id="comments-anchor" class="comment-area-title border-box">
            <i class="fas fa-comments"></i>&nbsp;è¯„è®º
        </div>
        <div class="comment-plugin-fail border-box">
    <span class="fail-tip">è¯„è®ºæ’ä»¶åŠ è½½å¤±è´¥</span>
    <button class="reload keep-button">ç‚¹å‡»é‡æ–°åŠ è½½</button>
</div>
<div class="comment-plugin-loading flex-center border-box">
    <i class="loading-icon fa-solid fa-spinner fa-spin"></i>
    <span class="load-tip">æ­£åœ¨åŠ è½½è¯„è®ºæ’ä»¶</span>
</div>
<script data-pjax>
  window.KeepCommentPlugin = {}
  window.KeepCommentPlugin.hideLoading = () => {
    const cplDom = document.querySelector('.comments-container .comment-plugin-loading')
    cplDom.style.display = 'none'
  }
  window.KeepCommentPlugin.loadFailHandle = () => {
    window.KeepCommentPlugin.hideLoading()
    const cpfDom = document.querySelector('.comments-container .comment-plugin-fail')
    cpfDom.style.display = 'flex'
    cpfDom.querySelector('.reload').addEventListener('click', () => {
      window.location.reload()
    })
  }
</script>

        
            

    <div class="valine-container">
        <div id="vcomments"></div>
        <script 
                src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"
                async
                onerror="window.KeepCommentPlugin.loadFailHandle()"
        ></script>
        <script 
                async
                onerror="window.KeepCommentPlugin.loadFailHandle()"
        >
          window.KeepCommentPlugin.initValine = () => {
            const config = {
              el: '#vcomments',
              appId: 'OcvtJuJHDrSFIyDGdp3rLMtA-gzGzoHsz',
              appKey: 'C672AAYGXMkHxztf8ntdLShs',
              meta: ['nick', 'mail', 'link'],
              avatar: 'wavatar',
              enableQQ: true,
              placeholder: 'ğŸ˜œè‹¥æœ‰é—®é¢˜è¯·å„ä½å¤§å¸ˆå‚…ç•™è¨€è¯„è®ºï¼ˆç•™ä¸‹é‚®ç®±æœ‰é€šçŸ¥å“¦ï½ï¼‰',
              lang: 'zh-CN'.toLowerCase()
            }

            if ('') {
              config.serverURLs = ''
            }

            if (window?.Valine) {
              new Valine(config)
              window.KeepCommentPlugin.hideLoading()
            } else {
              setTimeout(() => {
                window.KeepCommentPlugin.initValine()
              }, 1000)
            }
          }

          if ('false' === 'true') {
            setTimeout(() => {
              window.KeepCommentPlugin.initValine()
            }, 1200)
          } else {
            window.addEventListener('DOMContentLoaded', window.KeepCommentPlugin.initValine)
          }
        </script>
    </div>


        
    </div>





                
            </div>
        </div>

        
            <div class="pc-post-toc right-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-text">å‰è¨€</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#syzkaller%E4%BD%BF%E7%94%A8"><span class="nav-text">syzkallerä½¿ç”¨</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="nav-text">å·¥ä½œåŸç†</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-text">é…ç½®æ–‡ä»¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8syzkaller"><span class="nav-text">å¯åŠ¨syzkaller</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#syzlang%E7%BC%96%E5%86%99%E6%8C%87%E5%8D%97"><span class="nav-text">syzlangç¼–å†™æŒ‡å—</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#syzlang%E8%AF%AD%E6%B3%95"><span class="nav-text">syzlangè¯­æ³•</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%82%E6%95%B0"><span class="nav-text">å‚æ•°</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B1%BB%E5%9E%8B"><span class="nav-text">ç±»å‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8"><span class="nav-text">ç³»ç»Ÿè°ƒç”¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B4%E5%9E%8B"><span class="nav-text">æ•´å‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93"><span class="nav-text">ç»“æ„ä½“</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B5%84%E6%BA%90"><span class="nav-text">èµ„æº</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B1%BB%E5%9E%8B%E5%88%AB%E5%90%8D"><span class="nav-text">ç±»å‹åˆ«å</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B1%BB%E5%9E%8B%E6%A8%A1%E6%9D%BF"><span class="nav-text">ç±»å‹æ¨¡æ¿</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%95%BF%E5%BA%A6"><span class="nav-text">é•¿åº¦</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9B%E7%A8%8B"><span class="nav-text">è¿›ç¨‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B4%E5%9E%8B%E5%B8%B8%E9%87%8F"><span class="nav-text">æ•´å‹å¸¸é‡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B6%E4%BB%96"><span class="nav-text">å…¶ä»–</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B0%9D%E8%AF%95%E6%8D%95%E6%8D%89%E7%AE%80%E5%8D%95%E6%BA%A2%E5%87%BA%E6%B4%9E"><span class="nav-text">å°è¯•æ•æ‰ç®€å•æº¢å‡ºæ´</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#syz-extract"><span class="nav-text">syz-extract</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#syz-sysgen"><span class="nav-text">syz-sysgen</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E6%88%98%E6%B5%81%E7%A8%8B"><span class="nav-text">å®æˆ˜æµç¨‹</span></a></li></ol></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>
        </div>

        <div class="page-main-content-bottom border-box">
            
<footer class="footer border-box">
    <div class="copyright-info info-item">
        &copy;&nbsp;<span>2020</span>&nbsp;-&nbsp;2025
        
            &nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;&nbsp;<a href="/">196082</a>
        
    </div>

    <div class="theme-info info-item">
        ç”±&nbsp;<a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;é©±åŠ¨&nbsp;&&nbsp;ä¸»é¢˜&nbsp;<a class="keep-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep</a>
    </div>

    
        
        <div class="deploy-info info-item">
            
            æœ¬ç«™ç”± <span class="tooltip" data-tooltip-content="GitHub Pages"><img src="/images/brands/github.png"></span> æä¾›éƒ¨ç½²æœåŠ¡
            
        </div>
    

    
        <div class="count-info info-item">
            
                <span class="count-item border-box word">
                    <span class="item-type border-box">æ€»å­—æ•°</span>
                    <span class="item-value border-box word">335.6k</span>
                </span>
            

            
                <span class="count-item border-box uv">
                    <span class="item-type border-box">è®¿å®¢æ•°</span>
                    <span class="item-value border-box uv" id="busuanzi_value_site_uv"></span>
                </span>
            

            
                <span class="count-item border-box pv">
                    <span class="item-type border-box">è®¿é—®é‡</span>
                    <span class="item-value border-box pv" id="busuanzi_value_site_pv"></span>
                </span>
            
        </div>
    

    
</footer>

        </div>
    </div>

    <!-- post tools -->
    
        <div class="post-tools right-toc">
            <div class="post-tools-container border-box">
    <ul class="post-tools-list border-box">
        <!-- PC encrypt again -->
        

        <!-- PC TOC show toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- PC go comment -->
        
            <li class="tools-item flex-center go-to-comments">
                <i class="fas fa-comment"></i>
                <span class="post-comments-count"></span>
            </li>
        

        <!-- PC full screen -->
        <li class="tools-item flex-center full-screen">
            <i class="fa-solid fa-expand"></i>
        </li>
    </ul>
</div>

        </div>
    

    <!-- side tools -->
    <div class="side-tools">
        <div class="side-tools-container border-box ">
    <ul class="side-tools-list side-tools-show-handle border-box">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <!-- toggle mode -->
        
            <li class="tools-item tool-toggle-theme-mode flex-center">
                <i class="fas fa-moon"></i>
            </li>
        

        <!-- rss -->
        
            <li class="tools-item rss flex-center">
                <a class="flex-center"
                   href="/atom.xml"
                   target="_blank"
                >
                    <i class="fas fa-rss"></i>
                </a>
            </li>
        

        <!-- to bottom -->
        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list border-box">
        
            <li class="tools-item toggle-show-toc-tablet flex-center">
                <i class="fas fa-list"></i>
            </li>
        

        
            <li class="tools-item go-to-comments-tablet flex-center">
                <i class="fas fa-comment"></i>
            </li>
        

        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>

        <li class="tools-item tool-scroll-to-top flex-center show-arrow">
            <i class="arrow fas fa-arrow-up"></i>
            <span class="percent"></span>
        </li>
    </ul>
</div>

    </div>

    <!-- image mask -->
    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    <!-- local search -->
    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="æœç´¢..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="close-popup-btn">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

    <!-- tablet toc -->
    
        <div class="tablet-post-toc-mask">
            <div class="tablet-post-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-text">å‰è¨€</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#syzkaller%E4%BD%BF%E7%94%A8"><span class="nav-text">syzkallerä½¿ç”¨</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="nav-text">å·¥ä½œåŸç†</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-text">é…ç½®æ–‡ä»¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8syzkaller"><span class="nav-text">å¯åŠ¨syzkaller</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#syzlang%E7%BC%96%E5%86%99%E6%8C%87%E5%8D%97"><span class="nav-text">syzlangç¼–å†™æŒ‡å—</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#syzlang%E8%AF%AD%E6%B3%95"><span class="nav-text">syzlangè¯­æ³•</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%82%E6%95%B0"><span class="nav-text">å‚æ•°</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B1%BB%E5%9E%8B"><span class="nav-text">ç±»å‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8"><span class="nav-text">ç³»ç»Ÿè°ƒç”¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B4%E5%9E%8B"><span class="nav-text">æ•´å‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93"><span class="nav-text">ç»“æ„ä½“</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B5%84%E6%BA%90"><span class="nav-text">èµ„æº</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B1%BB%E5%9E%8B%E5%88%AB%E5%90%8D"><span class="nav-text">ç±»å‹åˆ«å</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B1%BB%E5%9E%8B%E6%A8%A1%E6%9D%BF"><span class="nav-text">ç±»å‹æ¨¡æ¿</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%95%BF%E5%BA%A6"><span class="nav-text">é•¿åº¦</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9B%E7%A8%8B"><span class="nav-text">è¿›ç¨‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B4%E5%9E%8B%E5%B8%B8%E9%87%8F"><span class="nav-text">æ•´å‹å¸¸é‡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B6%E4%BB%96"><span class="nav-text">å…¶ä»–</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B0%9D%E8%AF%95%E6%8D%95%E6%8D%89%E7%AE%80%E5%8D%95%E6%BA%A2%E5%87%BA%E6%B4%9E"><span class="nav-text">å°è¯•æ•æ‰ç®€å•æº¢å‡ºæ´</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#syz-extract"><span class="nav-text">syz-extract</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#syz-sysgen"><span class="nav-text">syz-sysgen</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E6%88%98%E6%B5%81%E7%A8%8B"><span class="nav-text">å®æˆ˜æµç¨‹</span></a></li></ol></li></ol>
    </div>
</div>

            </div>
        </div>
    
</main>





<!-- common js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.2/js/utils.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.2/js/header-shrink.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.2/js/back2top.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.2/js/toggle-theme.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.2/js/code-block.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.2/js/main.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.2/js/libs/anime.min.js"></script>

<!-- local search -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.2/js/local-search.min.js"></script>


<!-- lazyload -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.2/js/lazyload.min.js"></script>


<div class="">
    <!-- home page -->
    

    <!-- post page -->
    
        <!-- post-helper -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.2/js/post/post-helper.min.js"></script>

        <!-- toc -->
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-theme-keep/4.2.2/js/post/toc.min.js"></script>
        

        <!-- copyright-info -->
        

        <!-- share -->
        
    

    <!-- categories page -->
    

    <!-- links page -->
    

    <!-- photos page -->
    

    <!-- tools page -->
    
</div>

<!-- mermaid -->


<!-- pjax -->



</body>
</html>
